/*!
 * `rbroker` The DeployR RBroker Library v7.3.0
 * http://deployr.revolutionanalytics.com/documents/dev/rbroker-jsdoc
 *
 * Includes:
 *   - when: https://www.npmjs.org/package/when
 *   - enum: https://www.npmjs.org/package/enum
 *   - selfish: https://www.npmjs.org/package/selfish
 *   - merge: https://www.npmjs.org/package/merge
 *
 * Copyright (C) 2010-2014 by Revolution Analytics Inc.
 * Released under the Apache License 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 * Date: 2014-10-13
*/
!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.rbroker=a()}}(function(){var a,b,c;return function d(a,b,c){function e(g,h){if(!b[g]){if(!a[g]){var i=typeof require=="function"&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=b[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,d,a,b,c)}return b[g].exports}var f=typeof require=="function"&&require;for(var g=0;g<c.length;g++)e(c[g]);return e}({1:[function(a,b,c){var d=a("deployr"),e=a("merge"),f=a("when"),g=a("./rbroker-engine"),h=a("../worker/background-task-worker");b.exports=g.extend({initialize:function i(a){var b=10;g.initialize.call(this,e(a,{maxConcurrentTaskLimit:b}));d.configure({host:a.host,cors:a.cors,logging:a.logging});for(var c=0;c<this.parallelTaskLimit;c++){this.resourceTokenPool.offer(c)}this.ruser=d.io("/r/user/login").data(a.credentials).ctx(this).error(function(a){this.emit("error",a.get("error"))}).end(function(a){this.emit("ready")})},refresh:function(a){throw new Error("BackgroundTaskBroker refresh not supported.")},shutdown:function(){var a=this,b=f.defer();this.flush();return this.ruser.release()},createWorker:function(a){return h.new(a,this.ruser)}})},{"../worker/background-task-worker":12,"./rbroker-engine":4,deployr:19,merge:40,when:58}],2:[function(a,b,c){var d=a("deployr"),e=a("when"),f=a("./rbroker-engine"),g=a("../worker/discrete-task-worker");b.exports=f.extend({initialize:function h(a){f.initialize.call(this,a);d.configure({host:a.host,cors:a.cors,logging:a.logging});for(var b=0;b<this.parallelTaskLimit;b++){this.resourceTokenPool.offer(b)}if(a.credentials){this.ruser=d.io("/r/user/login").data(a.credentials).ctx(this).error(function(a){this.emit("error",a.get("error"))}).end(function(a){this.emit("ready")})}else{this.ruser=null;this.emit("ready")}},refresh:function(a){throw new Error("DiscreteTaskBroker refresh not supported.")},createWorker:function(a){return g.new(a,this.ruser)},shutdown:function(){var a=this,b=e.defer();this.flush();if(this.ruser){this.ruser.release().then(function(){b.resolve(true)},function(c){a.emit("error",c);b.reject(false)})}else{b.resolve(true)}return b.promise}})},{"../worker/discrete-task-worker":13,"./rbroker-engine":4,deployr:19,when:58}],3:[function(a,b,c){var d=a("deployr"),e=a("when"),f=a("merge"),g=a("./rbroker-engine"),h=a("../worker/pooled-task-worker");b.exports=g.extend({initialize:function i(a){g.initialize.call(this,a);if(!a.credentials){throw new Error("Broker failed to initialize, user credentials required.")}var b=this,c=a.maxConcurrentTaskLimit,e=f({poolsize:c},a.pool||{});d.configure({host:a.host,cors:a.cors,logging:a.logging,events:{error:function(a,c){b.emit("error",c.get("error"))}}});this.httpKeepAlive={id:null,PING_INTERVAL:6e4,start:function(a){this.stop();this.id=setInterval(function(){d.io("/r/user/about").share(a.getCookies()).end()},this.PING_INTERVAL)},stop:function(){clearInterval(this.id)}};function h(a){var c=a.get("error");if(c){b.emit("error",c)}a.get("projects").forEach(function(a){b.resourceTokenPool.offer(a.project)});b.parallelTaskLimit=b.resourceTokenPool.size();b.emit("ready");b.httpKeepAlive.start(b.ruser)}this.ruser=d.io("/r/user/login").data(a.credentials).ctx(this).end();if(a.releaseGridResources){this.ruser.io("/r/user/release").error(function(a){b.emit("error",a)}).end().io("/r/project/pool").data(e).end(function(a){h(a)})}else{this.ruser.io("/r/project/pool").data(e).end(function(a){h(a)})}},refresh:function(a){var b=this,c=[],g={},h=this.ruser;if(!this.isIdle()){var i=e.defer();i.reject(new Error("RBroker is not idle,  refresh not permitted."));return i.promise}a=a||{};g={code:"# Refresh project on PooledTaskBroker.",preloadfilename:a.preloadfilename,preloaddirectory:a.preloaddirectory,preloadfileauthor:a.preloadfileauthor,preloadfileversion:a.preloadfileversion};this.resourceTokenPool.q.forEach(function(a){c.push(d.io("/r/project/recycle").share(h.getCookies()).delay().data({project:a}).end().io("/r/project/execute/code").share(h.getCookies()).delay().data(f(g,{project:a})).end())});return d.pipeline(c)},shutdown:function(){var a=this,b=e.defer();this.httpKeepAlive.stop();this.flush();this.ruser.release(this.resourceTokenPool.q).then(function(){b.resolve(true)},function(c){a.emit("error",c);b.reject(new Error(c))});this.resourceTokenPool.q=[];return b.promise},createWorker:function(a){return h.new(a,this.ruser)}})},{"../worker/pooled-task-worker":14,"./rbroker-engine":4,deployr:19,merge:40,when:58}],4:[function(a,b,c){var d=a("selfish").Base,e=a("when"),f=a("deployr/lib/emitter"),g=a("../rtask-token"),h=a("../util/rtask-queue"),i=999;b.exports=d.extend(f,{initialize:function j(a){f.initialize.call(this);var b=this;this.config=a;this.scope=this.config.ctx||this;this.engineStarted=false;this.parallelTaskLimit=this.config.maxConcurrentTaskLimit;this.pendingLow=h.new(i);this.pendingHigh=h.new(i);this.resourceTokenPool=h.new(i);this.runtime={runningTasks:0,totals:{success:0,failure:0},buildStats:function(a,b){return{maxConcurrency:b,totalTasksRun:this.totals.success+this.totals.failure,totalTasksRunToSuccess:this.totals.success,totalTasksRunToFailure:this.totals.failure,totalTimeTasksOnCode:a.timeOnCode,totalTimeTasksOnServer:a.timeOnServer,totalTimeTasksOnCall:a.timeOnCall}},calibrate:function(a){this.runningTasks=this.runningTasks+a;if(this.runningTasks<0){this.runningTasks=0}return this.runningTasks}};this.on("ready",function(){b.engineStarted=true;for(var a=0;a<this.parallelTaskLimit;a++){if(!this.isIdle()){this.run()}else{break}}})},simulateApp:function(a){if(a){if(typeof a.simulateApp==="function"){a.simulateApp(this)}else{throw new Error('ReferenceError: "simulateApp" is not defined')}}},submit:function(a,b){var c=this.createWorker(a),d=g.new(c);if(b){this.pendingHigh.offer(c)}else{this.pendingLow.offer(c)}this.run();return d},maxConcurrency:function(){return this.parallelTaskLimit},flush:function(){this.pendingHigh.clear();this.pendingLow.clear();return this.status()},isConnected:function(){var a=e.defer(),b=this.ruser?this.ruser.io("/r/user/about"):deployr.io("/r/server/info");b.io(api).error(function(){a.reject(false)}).end(function(){a.resolve(true)});return a.promise},status:function(){var a=this.pendingHigh.size()+this.pendingLow.size(),b=this.parallelTaskLimit-this.runtime.runningTasks,c=this.isIdle();return{pending:a,executing:b,idle:c,toString:function(){return'\nRBrokerStatus: [ pending = "'+a+'" ] '+'[ executing = "'+b+'" ] '+'[ idle = "'+c+'" ]\n'}}},isIdle:function(){return this.runtime.runningTasks===0&&this.pendingLow.isEmpty()&&this.pendingHigh.isEmpty()},error:function(a){this.on("error",a);return this},complete:function(a){this.on("complete",a);return this},idle:function(a){this.on("idle",a);return this},progress:function(a){this.on("progress",a);return this},run:function(){var a=this,b,c;if(this.engineStarted&&!this.resourceTokenPool.isEmpty()&&(!this.pendingLow.isEmpty()||!this.pendingHigh.isEmpty())){b=this.pendingHigh.take()||this.pendingLow.take();this.runtime.calibrate(+1);b.complete(function(b){a.runtime.totals.success++;a.emit("progress",a.runtime.buildStats(b.result,a.maxConcurrency()));a.emit("complete",b.task,b.result)}).error(function(b){a.runtime.totals.failure++;a.emit("error",b)}).ensure(function(b){a.runtime.calibrate(-1);a.resourceTokenPool.offer(b);a.run();if(a.isIdle()){a.emit("idle")}}).work(this.resourceTokenPool.take())}}})},{"../rtask-token":5,"../util/rtask-queue":11,"deployr/lib/emitter":21,selfish:41,when:58}],5:[function(a,b,c){var d=a("selfish").Base,e=a("./util/rtask-promise");b.exports=d.extend(e,{initialize:function f(a){this.defer=a.defer;this.cancelled=false},cancel:function(a){this.cancelled=true;this.worker.terminate(a);return this},getTask:function(){return this.worker.getTask()},isDone:function(){return this.worker.isDone()},isCancelled:function(){return this.cancelled}})},{"./util/rtask-promise":10,selfish:41}],6:[function(a,b,c){var d=a("selfish").Base,e=a("enum"),f=new e(["DISCRETE","POOLED","BACKGROUND"],"RTaskType");b.exports=d.extend({DISCRETE:f.DISCRETE,POOLED:f.POOLED,BACKGROUND:f.BACKGROUND})},{"enum":38,selfish:41}],7:[function(a,b,c){var d=a("selfish").Base;b.exports=d.extend({initialize:function(a){this.props=a},toJSON:function(){var a={};for(var b=Object.keys(this.props),c=b.length;c;--c){a[b[c-1]]=this.props[b[c-1]]}return a},toString:function(){var a="BackgroundTask: ";for(var b in this.props){a+=" [ "+b+' = "'+this.props[b]+'" ]'}return a}})},{selfish:41}],8:[function(a,b,c){var d=a("selfish").Base;b.exports=d.extend({initialize:function(a){this.props=a},toJSON:function(){var a={};for(var b=Object.keys(this.props),c=b.length;c;--c){a[b[c-1]]=this.props[b[c-1]]}return a},toString:function(){var a="DiscreteTask: ";for(var b in this.props){a+=" [ "+b+' = "'+this.props[b]+'" ]'}return a}})},{selfish:41}],9:[function(a,b,c){var d=a("selfish").Base;b.exports=d.extend({initialize:function(a){this.props=a},toJSON:function(){var a={};for(var b=Object.keys(this.props),c=b.length;c;--c){a[b[c-1]]=this.props[b[c-1]]}return a},toString:function(){var a="PooledTask: ";for(var b in this.props){a+=" [ "+b+' = "'+this.props[b]+'" ]'}return a}})},{selfish:41}],10:[function(a,b,c){var d=a("selfish").Base,e=a("when");b.exports=d.extend({ensure:function(a){var b=this;if(a){this.defer.promise.ensure(function(){a.call(b,b.resourceToken)})}return this},complete:function(a,b){this.defer.promise.done(a,b);return this},error:function(a){this.defer.promise.otherwise(a);return this},resolve:function(a){this.defer.resolve({task:this.task,result:a})},reject:function(a){this.defer.reject(a)}})},{selfish:41,when:58}],11:[function(a,b,c){var d=a("selfish").Base;var e=d.extend({initialize:function f(a){this.capacity=a;this.q=[]},offer:function(a){var b=this.size()<this.capacity;if(b){this.q.push(a)}return b},take:function(){return this.q.shift()},peek:function(){return this.q[0]},size:function(){return this.q.length},isEmpty:function(){return this.size()===0},clear:function(){this.q.length=0},iter:function(a){this.q.forEach(a)}});b.exports=e},{selfish:41}],12:[function(a,b,c){var d=a("selfish").Base,e=a("deployr"),f=a("../rtask-type"),g=a("./rbroker-worker");b.exports=g.extend({initialize:function h(a,b){g.initialize.call(this,a);this.ruser=b;this.job=null},work:function(a){var b=this,c=(new Date).getTime(),d=this.task.toJSON(),g=d.rinputs||[],h=d.routputs||[];delete d.rinputs;delete d.routputs;this.resourceToken=a;e.io("/r/job/submit").share(this.ruser.getCookies()).data(d).rinputs(g).routputs(h).error(function(a){b.reject(new Error(a.get("error")))}).end(function(a){var d=a.deployr.response.job;if(d){b.job=d.job;b.resolve({id:d.job,type:f.BACKGROUND,timeOnCode:0,timeOnServer:0,timeOnCall:(new Date).getTime()-c,success:true,failure:null})}});return this},terminate:function(){e.io("/r/job/cancel").share(this.ruser.getCookies()).data({job:this.job}).end();this.reject(new Error("BackgroundTaskWorker task terminated "+this.task))}})},{"../rtask-type":6,"./rbroker-worker":15,deployr:19,selfish:41}],13:[function(a,b,c){var d=a("selfish").Base,e=a("deployr"),f=a("../rtask-type"),g=a("./rbroker-worker");b.exports=g.extend({initialize:function h(a,b){g.initialize.call(this,a);this.io=null;this.ruser=b},work:function(a){var b=this,c=(new Date).getTime(),d=this.task.toJSON(),g=d.rinputs||[],h=d.routputs||[];delete d.rinputs;delete d.routputs;this.resourceToken=a;this.io=e.io("/r/repository/script/execute").share(this.ruser?this.ruser.getCookies():null).data(d).rinputs(g).routputs(h).error(function(a){b.reject(new Error(a.get("error")))}).end(function(a){a=a.deployr.response;var d=a.execution.timeTotal,e=a.project.project,g=a.execution.console,h=a.execution.results,i=a.execution.artifacts,j=a.workspace.objects,k=a.repository.files;b.resolve({id:e,type:f.DISCRETE,success:true,timeOnServer:d,timeOnCall:(new Date).getTime()-c,failure:null,interrupted:false,generatedConsole:g,generatedPlots:h,generatedFiles:i,generatedObjects:j,storedFiles:k})});return this},terminate:function(){this.reject(new Error("Worker task terminated "+this.task));if(this.io){this.io.abort();this.io.destroy();this.io=null}}})},{"../rtask-type":6,"./rbroker-worker":15,deployr:19,selfish:41}],14:[function(a,b,c){var d=a("selfish").Base,e=a("merge"),f=a("deployr"),g=a("../rtask-type"),h=a("./rbroker-worker");b.exports=h.extend({initialize:function i(a,b){h.initialize.call(this,a);this.ruser=b},work:function(a){var b=this,c=e({project:a},this.task.toJSON()),d=(new Date).getTime(),h=c.rinputs||[],i=c.routputs||[];delete c.rinputs;delete c.routputs;this.resourceToken=a;f.io("/r/project/execute/"+(c.code?"code":"script")).share(this.ruser.getCookies()).data(c).rinputs(h).routputs(i).error(function(a){b.reject(new Error(a.get("error")))}).end(function(a){a=a.deployr.response;var c=a.execution.console,e=a.execution.results,f=a.execution.artifacts,h=a.workspace.objects,i=a.repository.files;b.resolve({id:a.project.project,type:g.POOLED,success:true,timeOnCode:a.execution.timeCode,timeOnServer:a.execution.timeTotal,timeOnCall:(new Date).getTime()-d,failure:null,interrupted:false,generatedConsole:c,generatedPlots:e,generatedFiles:f,generatedObjects:h,storedFiles:i})});return this},terminate:function(){this.reject(new Error("PooledTaskWorker task terminated "+this.task));this.ruser.io("/r/project/execute/interrupt").data({project:this.resourceToken}).end()}})},{"../rtask-type":6,"./rbroker-worker":15,deployr:19,merge:40,selfish:41}],15:[function(a,b,c){var d=a("selfish").Base,e=a("when"),f=a("../util/rtask-promise");b.exports=d.extend(f,{initialize:function g(a){var b=this;this.task=a;this.defer=e.defer();this.done=false;this.defer.promise.done(function(){b.done=true})},isDone:function(){return this.done},getTask:function(){return this.task}})},{"../util/rtask-promise":10,selfish:41,when:58}],16:[function(a,b,c){},{}],17:[function(a,b,c){var d=b.exports={};d.nextTick=function(){var a=typeof window!=="undefined"&&window.setImmediate;var b=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(a){return function(a){return window.setImmediate(a)}}if(b){var c=[];window.addEventListener("message",function(a){var b=a.source;if((b===window||b===null)&&a.data==="process-tick"){a.stopPropagation();if(c.length>0){var d=c.shift();d()}}},true);return function d(a){c.push(a);window.postMessage("process-tick","*")}}return function e(a){setTimeout(a,0)}}();d.title="browser";d.browser=true;d.env={};d.argv=[];function e(){}d.on=e;d.once=e;d.off=e;d.emit=e;d.binding=function(a){throw new Error("process.binding is not supported")};d.cwd=function(){return"/"};d.chdir=function(a){throw new Error("process.chdir is not supported")}},{}],18:[function(a,b,c){b.exports={"/r/user/login":{method:"POST",format:"json"},"/r/user/logout":{method:"POST",format:"json"},"/r/user/about":{method:"POST",format:"json"},"/r/user/autosave":{method:"POST",format:"json"},"/r/user/release":{method:"POST",format:"json"},"/r/project/create":{method:"POST",format:"json"},"/r/project/pool":{method:"POST",format:"json"},"/r/project/recycle":{method:"POST",format:"json"},"/r/project/list":{method:"POST",format:"json"},"/r/project/ping":{method:"POST",format:"json"},"/r/project/about":{method:"POST",format:"json"},"/r/project/about/update":{method:"POST",format:"json"},"/r/project/save":{method:"POST",format:"json"},"/r/project/saveas":{method:"POST",format:"json"},"/r/project/close":{method:"POST",format:"json"},"/r/project/grant":{method:"POST",format:"json"},"/r/project/import":{method:"POST",format:"json",upload:true},"/r/project/export":{method:"POST",format:"json"},"/r/project/delete":{method:"POST",format:"json"},"/r/project/execute/code":{method:"POST",format:"json"},"/r/project/execute/script":{method:"POST",format:"json"},"/r/project/execute/interrupt":{method:"POST",format:"json"},"/r/project/execute/console":{method:"POST",format:"json"},"/r/project/execute/history":{method:"POST",format:"json"},"/r/project/execute/flush":{method:"POST",format:"json"},"/r/project/execute/result/list":{method:"POST",format:"json"},"/r/project/execute/result/download":{method:"POST",format:"json"},"/r/project/execute/result/delete":{method:"POST",format:"json"},"/r/project/workspace/list":{method:"POST",format:"json"},"/r/project/workspace/get":{method:"POST",format:"json"},"/r/project/workspace/upload":{method:"POST",format:"json",upload:true},"/r/project/workspace/transfer":{method:"POST",format:"json"},"/r/project/workspace/push":{method:"POST",format:"json"},"/r/project/workspace/save":{method:"POST",format:"json"},"/r/project/workspace/store":{method:"POST",format:"json"},"/r/project/workspace/load":{method:"POST",format:"json"},"/r/project/workspace/delete":{method:"POST",format:"json"},"/r/project/directory/list":{method:"POST",format:"json"},"/r/project/directory/upload":{method:"POST",format:"json",upload:true},"/r/project/directory/transfer":{method:"POST",format:"json"},"/r/project/directory/write":{method:"POST",format:"json"},"/r/project/directory/update":{method:"POST",format:"json"},"/r/project/directory/store":{method:"POST",format:"json"},"/r/project/directory/load":{method:"POST",format:"json"},"/r/project/directory/download":{method:"POST",format:"json"},"/r/project/directory/delete":{method:"POST",format:"json"},"/r/project/package/list":{method:"POST",format:"json"},"/r/project/package/attach":{method:"POST",format:"json"},"/r/project/package/detach":{method:"POST",format:"json"},"/r/job/list":{method:"POST",format:"json"},"/r/job/submit":{method:"POST",format:"json"},"/r/job/schedule":{method:"POST",format:"json"},"/r/job/query":{method:"POST",format:"json"},"/r/job/cancel":{method:"POST",format:"json"},"/r/job/delete":{method:"POST",format:"json"},"/r/repository/directory/list":{method:"POST",format:"json"},"/r/repository/directory/create":{method:"POST",format:"json"},"/r/repository/directory/rename":{method:"POST",format:"json"},"/r/repository/directory/copy":{method:"POST",format:"json"},"/r/repository/directory/move":{method:"POST",format:"json"},"/r/repository/directory/update":{method:"POST",format:"json"},"/r/repository/script/list":{method:"POST",format:"json"},"/r/repository/script/execute":{method:"POST",format:"json"},"/r/repository/script/render":{method:"POST",format:"json"},"/r/repository/script/interrupt":{method:"POST",format:"json"},"/r/repository/directory/archive":{method:"POST",format:"json"},"/r/repository/directory/upload":{method:"POST",format:"json",upload:true},"/r/repository/directory/download":{method:"POST",format:"json"},"/r/repository/directory/delete":{method:"POST",format:"json"},"/r/repository/file/list":{method:"POST",format:"json"},"/r/repository/file/fetch":{method:"POST",format:"json"},"/r/repository/file/fetch":{method:"POST",format:"json"},"/r/repository/file/upload":{method:"POST",format:"json",upload:true},"/r/repository/file/transfer":{method:"POST",format:"json"},"/r/repository/file/write":{method:"POST",format:"json"},"/r/repository/file/update":{method:"POST",format:"json"},"/r/repository/file/diff":{method:"POST",format:"json"},"/r/repository/file/revert":{method:"POST",format:"json"},"/r/repository/file/grant":{method:"POST",format:"json"},"/r/repository/file/download":{method:"POST",format:"json"},"/r/repository/file/delete":{method:"POST",format:"json"},"/r/repository/file/copy":{method:"POST",format:"json"},"/r/repository/file/move":{method:"POST",format:"json"},"/r/server/info":{method:"GET",format:"json"}}},{}],19:[function(a,b,c){var d=typeof window!=="undefined",e=a("superagent"),f=a("d.js"),g=a("fs"),h=a("./apis.json"),i=a("./lib/es"),j=a("./lib/utils"),k=a("./lib/lang"),l=a("./lib/logger"),m=a("./lib/queue"),n=a("./lib/emitter"),o=a("./lib/encoder"),p=a("./lib/selfish").Base,q=a("./lib/rinput"),r=a("./lib/rinputs"),s=j.merge;l.setLevel(l.OFF);var t={cors:false,logging:false,sticky:false,cookies:null,host:"",maxRequests:null,events:{},set:function(a,b){if(a!=="set"){this[a]=b}}};var u=["user","project","workspace","execution","directory","repository","packages"];function v(a,b){var c=b.deployr?b.deployr.response.errorCode:b.status,d=this;if(t.events){if(!b.deployr){b=b.text}d=t.events.ctx||d;if(t.events.error){t.events.error.apply(d,[a,b])}if(t.events[c]){t.events[c].apply(d,[a,b])}}}var w=p.extend(n,r,{initialize:function x(a,b){n.initialize.call(this,{});var c=t;if(!h[a]){throw new Error('Invalid API "'+a+'"')}this.api=s({call:a},h[a]);this.link=b||{};this.q=this.link.queue||new m;this.deferred=this.link.deferred||f();this.cookies=this.link.cookies;this.logger=l.get(a,l.OFF);this.params={};this.inputs=[];this.outputs=[];this.rstream=false;this.delayed=false;this.file=null;this.filter=null;this.data({format:this.api.format});this.req=e[this.api.method.toLowerCase()](c.host+"/deployr"+a);this.req.timeout(20*60*1e3);if(d&&t.cors){this.req.withCredentials()}if(this.api.upload){if(!d){this.req.type("multipart/form-data")}}else{this.req.type("form")}},ctx:function(a){this.scope=a||this;return this},share:function(a){if(t.sticky){if(t.cookies){this.cookies=t.cookies.slice(0)}else{if(a){this.cookies=a.slice(0);t.set("cookies",this.cookies)}}}else{this.cookies=a?a.slice(0):this.cookies}return this},getCookies:function(){return this.cookies},delay:function(a){this.delayed=!isNaN(parseFloat(a))&&isFinite(a)?a:true;return this},drain:function(){this.delayed=false;this.q.flush();return this.deferred.promise},promise:function(){this.end();return this.deferred.promise},abort:function(){this.req.abort();this.emit("abort");return this},timeout:function(a){this.req.timeout(a);return this},log:function(a){this.logger.setLevel(a||l.DEBUG);return this},entity:function(a){this.filter=j.inArray(u,a);return this},data:function(a){a=a||{};if(a.rinput||a.rinputs){this.rinput(a.rinput);this.rinputs(a.rinputs)}var b=["rinput","rinputs","__cookies__"];b.forEach(function(b){delete a[b]});this.params=s(this.params,a);return this},attach:function(a,b){if(this.api.upload){this.file=a;if(b){this.data({filename:b})}}return this},stream:function(){this.rstream=!d&&this.api.upload;return this},ensure:function(a){this.deferred.promise.ensure(a);return this.deferred.promise},error:function(a){var b=this;this.on("error",a);this.req.on("error",function(a){b.emit("error",a)});return this},pipe:function(a){var b=this.q,c=this.api;b.add(function(d,e,f){if(e){this.deferred.reject(e);b.flush(d,e,f);this._clear();return}this._prepRequest(d,f);l.info("pipe()",c,this.req);this.logger.info("pipe()",c,this.req);var g=this.req.pipe(a);b.yield(true);g.on("error",function(){});g.on("end",function(){});g.on("data",function(){})},this);if(b.size()<=1){b.flush()}return a},end:function(a){var b=this,c=this.q,d=this.api,e=null,f=this.filter;c.add(function(g,h,i){if(h){this.deferred.reject(h);c.flush(g,h,i);this._clear();return}this._prepRequest(g,i);l.info("io()",d,this.req);this.logger.info("io()",d,this.req);this.req.end(function(i){b.share(b.cookies||i.headers["set-cookie"]);if(b.cookies){l.info("cookies",d,b.cookies);b.logger.info("cookies",d,b.cookies)}h=b._handleError(i);var k=i.body&&i.body.deployr?i.body:i;b.inputs=[];b.outputs=[];if(!h){l.info("end()",d,k,i);b.logger.info("end()",d,k,i);if(f){k=k.deployr.response[f]||k}k.get=function(a){return j.get(k.deployr.response,a)};k.workspace=function(a){return j.workspace(k.deployr.response,a)};if(a){e=a.apply(b.scope,[k,g])}if(c.size()===0){b._clear();b.deferred.resolve(g||k)}e=s(e,{__cookies__:b.cookies})}c.yield(false);c.flush(k,h,e)});c.yield(true)},this,this.delayed);if(!this.delayed&&c.size()<=1){c.flush()}return this},io:function(a){return w.new(a,{cookies:this.cookies,queue:this.q,deferred:this.deferred})},script:function(){var a=j.signature(arguments),b=a.opts,c=a.api,d={cookies:this.cookies,queue:this.q,deferred:this.deferred};if(b.project&&k.isBoolean(b.project)){delete b["project"];return w.new("/r/project/create",d).end(function(a){return{project:a.get("project").project}}).io(c).data(b)}else{return w.new(c,d).data(b)}},release:function(a,b){a=k.isArray(a)?a:[a];var c=this,d=f(),e=!a||!a[0],g=0,h=!e?a.length-1:g,i=this.getCookies();function j(a){if(a===h){if(!b){w.new("/r/user/logout").share(i).error(function(){d.reject(false)}).end(function(){d.resolve(true)}).ensure(function(){c.destroy()})}else{d.resolve(true);c.destroy()}}}if(!e){a.forEach(function(a){w.new("/r/project/close").data({project:a}).share(i).end().ensure(function(){j(g);g++})})}else{j(g)}return d.promise},routputs:function(a){if(a){this.outputs=this.outputs.concat(a)}return this},routput:function(a){if(a){this.routputs([a])}return this},rinputs:function(a){if(a){this.inputs=this.inputs.concat(a)}return this},rinput:function(a){if(a){this.inputs.push(a)}return this},destroy:function(){try{this.emit("destroy");this.offAll();for(var a in this){if(this.hasOwnProperty(a)){this[a]=null;delete this[a]}}}catch(b){}},_clear:function(){this.api=null;this.params={};this.inputs=[];this.outputs=[];this.rstream=false;this.delayed=false;this.file=null;this.filter=null},_prepRequest:function(a,b){var c=this.req,d=this.file;this.share(b?b.__cookies__:null);if(b){this.data(b)}if(this.inputs.length>0){this.data({inputs:o.encode(this.inputs)})}if(this.outputs.length>0){this.data({robjects:this.outputs.join()})}if(this.cookies){this.cookies.forEach(function(a){c.set("Cookie",a)})}if(this.api.upload){for(var e in this.params){c.field(e,this.params[e]?this.params[e]+"":"")}c.attach("file",this.rstream?g.createReadStream(d):d)}else{c[this.api.method==="GET"?"query":"send"](this.params)}},_handleError:function(a){var b=a.status,c=a.body&&a.body.deployr?a.body:a,d=b!==200||c.deployr&&!c.deployr.response.success;if(d){c={get:function(a){return j.get(this.deployr.response,a)},deployr:{response:{success:false,call:this.api["call"],errorCode:c.deployr?c.deployr.response.errorCode:b,error:c.deployr?c.deployr.response.error:c.text}}};l.error("error()",this.api,c,a);this.logger.error("error()",this.api,c,a);v(this.api["call"],c);this.emit("error",c);this.emit("deployr-io:"+c.deployr.response.errorCode,c);this.deferred.reject(c)}return d}});if(d){window.Revolution=window.Revolution||a("./lib/deprecated")}b.exports={configure:function(a){a=a||{};for(var b in a){t.set(b,a[b])}if(!t.sticky){t.set("cookies",null)}l.setLevel(t.logging?l.DEBUG:l.OFF);return this},io:function(a){return w.new(a)},auth:function(a,b){var c={username:a,password:b};return w.new("/r/user/login").data(c).end()},script:function(){var a=j.signature(arguments),b=a.opts,c=a.api;if(b.project&&k.isBoolean(b.project)){delete b["project"];return w.new("/r/project/create").end(function(a){return{project:a.get("project").project}}).io(c).data(b)}else{return w.new(c).data(b)}},pipeline:function(a){var b=this,c=f(),d=new m,e=[],g=[],h=null,i={sticky:t.sticky,cookies:t.cookies};a=a.slice(0);b.configure({sticky:true});function j(){d.add(function(){a.shift().drain().then(function(a){e.push(a);g.push(h);if(d.isEmpty()){b.configure(i);c.resolve({results:e,errors:g})}d.take()},function(a){e.push(h);g.push(a);if(d.isEmpty()&&e.length===0){b.configure(i);c.reject(g)}d.take()})},null,true)}for(var k=0;k<a.length;k++){j()}d.take();return c.promise},es:function(a){var b=i.new(t.host,a);if(a&&a.username&&a.password){var c=this.auth(a.username,a.password);c.ensure(function(){b.share(c.getCookies());b.flush()})}return b},RInput:{numeric:function(a,b){return q.new(a,b).numeric()},integer:function(a,b){return q.new(a,b).integer()},logical:function(a,b){return q.new(a,b).logical()},character:function(a,b){return q.new(a,b).character()},date:function(a,b){return q.new(a,b).date()},posixct:function(a,b){return q.new(a,b).posixct()},numericVector:function(a,b){return q.new(a,b).numericVector()},integerVector:function(a,b){return q.new(a,b).integerVector()},logicalVector:function(a,b){return q.new(a,b).logicalVector()},characterVector:function(a,b){return q.new(a,b).characterVector()},dateVector:function(a,b){return q.new(a,b).dateVector()},posixctVector:function(a,b){return q.new(a,b).posixctVector()},list:function(a,b){return q.new(a,b).list()},dataframe:function(a,b){return q.new(a,b).dataframe()},factor:function(a,b,c,d){var e={levels:c,labels:d};return q.new(a,b,e).factor()},ordered:function(a,b,c,d){var e={levels:c,labels:d};return q.new(a,b,e).ordered()},numericMatrix:function(a,b){return q.new(a,b).numericMatrix()},integerMatrix:function(a,b){return q.new(a,b).integerMatrix()},logicalMatrix:function(a,b){return q.new(a,b).logicalMatrix()},characterMatrix:function(a,b){return q.new(a,b).characterMatrix()}}}},{"./apis.json":18,"./lib/deprecated":20,"./lib/emitter":21,"./lib/encoder":22,"./lib/es":23,"./lib/lang":24,"./lib/logger":25,"./lib/queue":27,"./lib/rinput":28,"./lib/rinputs":29,"./lib/selfish":31,"./lib/utils":32,"d.js":33,fs:16,superagent:34}],20:[function(a,b,c){var d=a("./lang"),e=a("./selfish").Base,f=a("./rinput");var g,h,i={},j=["user","project","workspace","execution","directory","repository","packages"];var k={ENDPOINT_WHITELIST:{login:"/r/user/login",logout:"/r/user/logout",projectCreate:"/r/project/create",projectClose:"/r/project/close",projectAboutUpdate:"/r/project/about/update",projectSave:"/r/project/save",projectSaveAs:"/r/project/saveas",clientProjectSave:"/r/client/project/save",clientProjectClose:"/r/client/project/close"},session:{},config:{},setUnloadConfig:function(a){a=a||{};this.config={disableautosave:a.disableautosave||true,dropworkspace:a.dropworkspace||true,dropdirectory:a.dropdirectory||true,drophistory:a.drophistory||true,flushhistory:a.flushhistory||true}},setSession:function(a){this.session=a},setProject:function(a){this.session.project=a},clearSession:function(){this.session={}},clearProject:function(){this.session.project=null},unloadHandler:function(){try{var a=this.session.project;if(a){var b=this._config;b.project=a.id;b.projectcookie=a.cookie;deployr.io("/r/project/close").data(b).sync().end()}}catch(c){throw new Error(c)}}};function l(a,b){var c=b||globalConfig.entity;if(c){var d=a.deployr.response,e=j;for(var f=0;f<e.length;f++){var g=e[f];if(d[g]&&c[g]){if(c[g].parser){var h=c[g].scope||this;d[g]=c[g].parser.call(h,d[g])}}}}return a}function m(a,b,c){var d=a.deployr.response,e=k.ENDPOINT_WHITELIST;switch(b){case e.login:k.setSession({httpcookie:d.httpcookie,user:d.user,limits:d.limits,project:null});break;case e.logout:k.clearSession();break;case e.projectClose:case e.clientProjectClose:k.clearProject();break;case e.projectCreate:case e.projectAboutUpdate:case e.projectSave:case e.projectSaveAs:case e.clientProjectSave:var f=d.project;k.setProject({id:f.project,cookie:f.cookie});break}g.Event.fire("DeployR:endpointChange",{response:a,endpoint:b,args:c})}function n(a){a=a.replace("/r/","");return a.toLowerCase().replace(/\/(.)/g,function(a,b){return b.toUpperCase()})}function o(a){var b=[];for(var c=0;c<a.length;c++){b.push(a[c].normalize())}return b}var p=e.extend({initialize:function(a,b,c){this.type=a;this.rclass=b;this.rinput=c},getType:function(){return this.type},getRClass:function(){return this.rclass},getName:function(){return this.rinput.name},getValue:function(){return this.rinput.value},getLevels:function(){return this.rinput.levels},getLabels:function(){return this.rinput.labels},getOrdered:function(){return this.rinput.ordered},normalize:function(){return this.rinput}});function q(a){}function r(a){}q.prototype={events:{},scope:null,on:function(a,b){if(a in this.events===false){this.events[a]=[]}this.events[a].push(b);r('Emitter.on("'+a+'")');return this},emit:function(a){if(a in this.events===false){return this}for(var b=0;b<this.events[a].length;b++){r('Fired event: "'+a+'"');this.events[a][b].apply(this.scope||this,Array.prototype.slice.call(arguments,1))}return this
},removeAllListeners:function(a){if(!a){for(var b in this.events){delete this.events[b]}}else{if(a in this.events===false){return this}delete this.events[a]}return this},removeListenerAt:function(a,b){var c=this.events[a],d=c.slice(b+1);c.length=b;c.push.apply(c,d);this.events[a]=c},off:function(a,b){if(a in this.events===false){return this}if(!b){return this.removeAllListeners(a)}else{for(var c=0;c<this.events[a].length;c++){if(this.events[a][c]==b){this.removeListenerAt(a,c);return this}}}return this}};h=new q;g={version:a("../package").version,Event:{on:function(a,b,c){h.on(a,b,c)},detach:function(a,b,c){h.off(a,b)}},RDataFactory:{createNumeric:function(a,b){return p.new("primitive","numeric",f.new(a,b).numeric())},createInteger:function(a,b){return p.new("primitive","integer",f.new(a,b).integer())},createBoolean:function(a,b){return p.new("primitive","numeric",f.new(a,b).logical())},createString:function(a,b){return p.new("primitive","character",f.new(a,b).character())},createDate:function(a,b){return p.new("date","Date",f.new(a,b).date())},createPOSIXDate:function(a,b){return p.new("date","POSIXct",f.new(a,b).posixct())},createNumericVector:function(a,b){return p.new("vector","numeric",f.new(a,b).numericVector())},createIntegerVector:function(a,b){return p.new("vector","integer",f.new(a,b).integerVector())},createBooleanVector:function(a,b){return p.new("vector","logical",f.new(a,b).logicalVector())},createStringVector:function(a,b){return p.new("vector","character",f.new(a,b).characterVector())},createDateVector:function(a,b){return p.new("type","Date",f.new(a,b).dateVector())},createPOSIXDateVector:function(a,b){return p.new("vector","POSIXct",f.new(a,b).posixctVector())},createList:function(a,b){return p.new("list","list",f.new(a,b).list())},createDataframe:function(a,b){return p.new("dataframe","data.frame",f.new(a,b).dataframe())},createFactor:function(a,b,c,d,e){var g={levels:d,labels:e};if(c){return p.new("factor","factor",f.new(a,b,g).ordered())}else{return p.new("factor","factor",f.new(a,b,g).factor())}},createNumericMatrix:function(a,b){return p.new("matrix","matrix",f.new(a,b).numericMatrix())},createIntegerMatrix:function(a,b){return p.new("matrix","matrix",f.new(a,b).integerMatrix())},createBooleanMatrix:function(a,b){return p.new("matrix","matrix",f.new(a,b).logicalMatrix())},createStringMatrix:function(a,b){return p.new("matrix","matrix",f.new(a,b).characterMatrix())}},DeployR:{init:function(a){a=a||{};if(a.compatibility){}if(a.events){var b=a.events;if(b.unload){k.setUnloadConfig(b.unload);g.Event.on("deployR:unload",k.unloadHandler,k)}if(b.globalIO){var c=b.globalIO.scope||window,d=b.globalIO.lifecycle,e=b.globalIO.statusCode;if(d){for(var f in d){g.Event.on("deployR-io:"+f,d[f],c)}}if(e){for(var f in e){g.Event.on("deployR-io:"+f,e[f],c)}}}}deployr.configure({host:a.deployrURI,cors:a.deployrURI?true:false,logging:a.logging,sticky:true})},io:function(a,b,c){if(console){console.warn('"'+n(a)+'()" API is now deprecated.')}c=c||{};b=b||{};var d=b.transaction||{},e=d["arguments"],f=d.statusCode||{},g=c.scope||window,i=b.robjects,j=b.inputs;if(b.transaction){delete b.transaction}if(b.method){delete b.method}if(b.on){delete b.on}if(b.format){delete b.format}if(b.inputs){delete b.inputs}if(b.robjects){delete b.robjects}var k=deployr.io(a).data(b||{}).error(function(b){h.emit("deployR-io:failure",[b,a,e]);if(c.failure){c.failure.apply(g,[b,a,e])}h.emit("deployR-io:"+code,[b,a,e])});if(j){k.rinputs(o(j))}if(i){k.routputs(i)}if(d.sync){k.sync()}if(d.timeout){k.timeout(d.timeout)}if(f){for(var m in f){k.on("deployr-io:"+m,function(b){var c=f;var d=b.deployr.response.error;var h=b.deployr.response.errorCode;c[h].apply(g,[b,h,d,a,e])})}}h.emit("deployR-io:start");if(c.start){c.start.apply(g,[a,e])}k.end(function(b){h.emit("deployR-io:complete");if(c.complete){c.complete.apply(g,[b,a,e])}if(d.entity){b=l(b,d.entity)}h.emit("deployR-io:success",[b,a]);if(c.success){c.success.apply(g,[b,a,e])}h.emit("deployR-io:end",[b,a]);if(c.end){c.end.apply(g,[b,a,e])}});return k},parseInputs:function(a){return a},projectWorkspaceList:function(a,b){return this.io("/r/project/workspace/list",a,b)},projectWorkspaceGet:function(a,b){return this.io("/r/project/workspace/get",a,b)},projectWorkspaceUpload:function(a,b){a.format="text";var c={data:a,method:"POST",form:{id:a.formId},on:b};return this.io("/r/project/workspace/upload",a,b)},projectWorkspaceTransfer:function(a,b){return this.io("/r/project/workspace/transfer",a,b)},projectWorkspacePush:function(a,b){return this.io("/r/project/workspace/push",a,b)},projectWorkspaceSave:function(a,b){return this.io("/r/project/workspace/save",a,b)},projectWorkspaceStore:function(a,b){return this.io("/r/project/workspace/store",a,b)},projectWorkspaceLoad:function(a,b){return this.io("/r/project/workspace/load",a,b)},projectWorkspaceDelete:function(a,b){return this.io("/r/project/workspace/delete",a,b)},projectCreate:function(a,b){return this.io("/r/project/create",a,b)},projectPool:function(a,b){return this.io("/r/project/pool",a,b)},projectRecycle:function(a,b){return this.io("/r/project/recycle",a,b)},projectList:function(a,b){return this.io("/r/project/list",a,b)},projectPing:function(a,b){return this.io("/r/project/ping",a,b)},projectAbout:function(a,b){return this.io("/r/project/about",a,b)},projectAboutUpdate:function(a,b){return this.io("/r/project/about/update",a,b)},projectSave:function(a,b){return this.io("/r/project/save",a,b)},projectSaveas:function(a,b){return this.io("/r/project/saveas",a,b)},projectClose:function(a,b){return this.io("/r/project/close",a,b)},projectGrant:function(a,b){return this.io("/r/project/grant",a,b)},projectImport:function(a,b){a.format="text";var c={data:a,method:"POST",form:{id:a.formId},on:b};return this.io("/r/project/import",a,b)},projectExport:function(a,b){return this.io("/r/project/export",a,b)},projectDelete:function(a,b){return this.io("/r/project/delete",a,b)},projectExecuteCode:function(a,b){return this.io("/r/project/execute/code",a,b)},projectExecuteScript:function(a,b){return this.io("/r/project/execute/script",a,b)},projectExecuteInterrupt:function(a,b){return this.io("/r/project/execute/interrupt",a,b)},projectExecuteConsole:function(a,b){return this.io("/r/project/execute/console",a,b)},projectExecuteHistory:function(a,b){return this.io("/r/project/execute/history",a,b)},projectExecuteFlush:function(a,b){return this.io("/r/project/execute/flush",a,b)},projectExecuteResultList:function(a,b){return this.io("/r/project/execute/result/list",a,b)},projectExecuteResultDownload:function(a,b){return this.io("/r/project/execute/result/download",a,b)},projectExecuteResultDelete:function(a,b){return this.io("/r/project/execute/result/delete",a,b)},projectDirectoryList:function(a,b){return this.io("/r/project/directory/list",a,b)},projectDirectoryUpload:function(a,b){a.format="text";var c={data:a,method:"POST",form:{id:a.formId},on:b};return this.io("/r/project/directory/upload",a,b)},projectDirectoryTransfer:function(a,b){return this.io("/r/project/directory/transfer",a,b)},projectDirectoryWrite:function(a,b){return this.io("/r/project/directory/write",a,b)},projectDirectoryUpdate:function(a,b){return this.io("/r/project/directory/update",a,b)},projectDirectoryStore:function(a,b){return this.io("/r/project/directory/store",a,b)},projectDirectoryLoad:function(a,b){return this.io("/r/project/directory/load",a,b)},projectDirectoryDownload:function(a,b){return this.io("/r/project/directory/download",a,b)},projectDirectoryDelete:function(a,b){return this.io("/r/project/directory/delete",a,b)},projectPackageList:function(a,b){return this.io("/r/project/package/list",a,b)},projectPackageAttach:function(a,b){return this.io("/r/project/package/attach",a,b)},projectPackageDetach:function(a,b){return this.io("/r/project/package/detach",a,b)},userLogin:function(a,b){return this.io("/r/user/login",a,b)},userLogout:function(a,b){return this.io("/r/user/logout",a,b)},userAbout:function(a){return this.io("/r/user/about",{},a)},userAutosave:function(a,b){return this.io("/r/user/autosave",a,b)},repositoryScriptList:function(a){return this.io("/r/repository/script/list",{},a)},repositoryScriptExecute:function(a,b){return this.io("/r/repository/script/execute",a,b)},repositoryScriptRender:function(a,b){return this.io("/r/repository/script/render",a,b)},repositoryScriptInterrupt:function(a){return this.io("/r/repository/script/interrupt",config,a)},repositoryFileList:function(a,b){return this.io("/r/repository/file/list",a,b)},repositoryFileUpload:function(a,b){a.format="text";var c={data:a,method:"POST",form:{id:a.formId},on:b};return this.io("/r/repository/file/upload",a,b)},repositoryFileTransfer:function(a,b){return this.io("/r/repository/file/transfer",a,b)},repositoryFileWrite:function(a,b){return this.io("/r/repository/file/write",a,b)},repositoryFileUpdate:function(a,b){return this.io("/r/repository/file/update",a,b)},repositoryFileRevert:function(a,b){return this.io("/r/repository/file/revert",a,b)},repositoryFileDiff:function(a,b){return this.io("/r/repository/file/diff",a,b)},repositoryFileGrant:function(a,b){return this.io("/r/repository/file/grant",a,b)},repositoryFileDownload:function(a,b){return this.io("/r/repository/file/download",a,b)},repositoryFileDelete:function(a,b){return this.io("/r/repository/file/delete",a,b)},repositoryFileFetch:function(a,b){return this.io("/r/repository/file/fetch",a,b)},repositoryFileCopy:function(a,b){return this.io("/r/repository/file/copy",a,b)},repositoryFileMove:function(a,b){return this.io("/r/repository/file/move",a,b)},repositoryDirectoryList:function(a,b){return this.io("/r/repository/directory/list",a,b)},repositoryDirectoryCreate:function(a,b){return this.io("/r/repository/directory/create",a,b)},repositoryDirectoryRename:function(a,b){return this.io("/r/repository/directory/rename",a,b)},repositoryDirectoryCopy:function(a,b){return this.io("/r/repository/directory/copy",a,b)},repositoryDirectoryMove:function(a,b){return this.io("/r/repository/directory/move",a,b)},repositoryDirectoryUpdate:function(a,b){return this.io("/r/repository/directory/update",a,b)},repositoryDirectoryArchive:function(a,b){return this.io("/r/repository/directory/archive",a,b)},repositoryDirectoryUpload:function(a,b){a=a||{};a.format="text";var c={data:a,method:"POST",form:{id:a.formId},on:b};return this.io("/r/repository/directory/upload",a,b)},repositoryDirectoryDownload:function(a,b){return this.io("/r/repository/directory/download",a,b)},repositoryDirectoryDelete:function(a,b){return this.io("/r/repository/directory/delete",a,b)},jobList:function(a,b){return this.io("/r/job/list",a,b)},jobSubmit:function(a,b){return this.io("/r/job/submit",a,b)},jobSchedule:function(a,b){return this.io("/r/job/schedule",a,b)},jobQuery:function(a,b){return this.io("/r/job/query",a,b)},jobCancel:function(a,b){return this.io("/r/job/list",a,b)},jobDelete:function(a,b){return this.io("/r/job/delete",a,b)}}};b.exports=g},{"../package":37,"./lang":24,"./rinput":28,"./selfish":31}],21:[function(a,b,c){var d=a("./selfish").Base;function e(a){}b.exports=d.extend({initialize:function(){this.events={};this.scope=null},on:function(a,b){if(a in this.events===false){this.events[a]=[]}this.events[a].push(b);e('Emitter.on("'+a+'")');return this},emit:function(a){if(a in this.events===false){return this}for(var b=0;b<this.events[a].length;b++){e('Fired event: "'+a+'"');this.events[a][b].apply(this.scope||this,Array.prototype.slice.call(arguments,1))}return this},offAll:function(a){if(!a){for(var b in this.events){delete this.events[b]}}else{if(a in this.events===false){return this}delete this.events[a]}return this},offAt:function(a,b){var c=this.events[a],d=c.slice(b+1);c.length=b;c.push.apply(c,d);this.events[a]=c},off:function(a,b){if(a in this.events===false){return this}if(!b){return this.offAll(a)}else{for(var c=0;c<this.events[a].length;c++){if(this.events[a][c]==b){this.offAt(a,c);return this}}}return this}})},{"./selfish":31}],22:[function(a,b,c){var d=a("./lang"),e=a("./rtypes"),f=e.r,g=e.deployr;function h(a,b){var c=[];for(var d=0;d<a.length;d++){c.push(i(a[d],b))}return c}function i(a,b){var c=a.getFullYear(),d=a.getMonth()+1,e=a.getDate(),f=a.getHours(),h=a.getMinutes(),i=a.getSeconds(),j=a.getTimezoneOffset(),k="";d=d<10?"0"+d:d;f=f<10?"0"+f:f;h=h<10?"0"+h:h;i=i<10?"0"+i:i;k=c+"-"+d+"-"+e;function l(a,b,c){var d=""+Math.abs(a),e=a>=0;while(d.length<b){d="0"+d}return(e?c?"+":"":"-")+d}if(b===g.RPOSIX_DATE||b===g.RPOSIX_DATE_VECTOR){var m=f+":"+h+":"+i,n=-j,o="+";if(n<0){n=-n;o="-"}j=o+l(n/60,2)+""+l(n%60,2);k+=" "+m+" "+j}return k}function j(a,b){var c=a.value;for(var f=0;f<c.length;f++){var k=c[f];if(k.type===g.RDATAFRAME){b=j(k,b)}else{if(e.isDate(k.type)){if(d.isArray(k.value)){k.value=h(k.value,k.type)}else{k.value=i(k.value,k.type)}}k.type=e.deployrToR(k.type);b.value.push(k)}}return b}function k(a){var b={type:f.DATAFRAME,value:[],name:a.name},c=a.value;for(var k=0;k<c.length;k++){var l=c[k];if(l.type===g.RDATAFRAME){b=j(l,b)}else{if(e.isDate(l.type)){if(d.isArray(l.value)){l.value=h(l.value,l.type)}else{l.value=i(l.value,l.type)}}l.type=e.deployrToR(l.type);b.value.push(l)}}return b}function l(a){var b={type:f.LIST,value:[],name:a.name},c=a.value,d;for(var e=0;e<c.length;e++){var j=c[e];switch(j.type){case g.RDATAFRAME:d=k(j);break;case g.RLIST:d=l(j);break;case g.RNUMERIC_MATRIX:case g.RINTEGER_MATRIX:case g.RBOOLEAN_MATRIX:case g.RSTRING_MATRIX:d={name:j.name,type:f.MATRIX,value:j.value};break;case g.RDATE:case g.RPOSIX_DATE:d={name:j.name,type:f.DATE,format:j.format,value:i(j.value,j.type)};break;case g.RFACTOR:case g.RORDERED:d={name:j.name,type:f.FACTOR,ordered:j.ordered,labels:j.labels,levels:j.levels,value:j.value};break;case g.RSTRING:case g.RBOOLEAN:case g.RNUMERIC:case g.RINTEGER:d={name:j.name,type:f.PRIMITIVE,value:j.value};break;case g.RNUMERIC_VECTOR:case g.RINTEGER_VECTOR:case g.RBOOLEAN_VECTOR:case g.RSTRING_VECTOR:d={name:j.name,type:f.VECTOR,value:j.value};break;case g.RDATE_VECTOR:case g.RPOSIX_DATE_VECTOR:d={name:j.name,type:f.VECTOR,value:h(j.value,j.type),format:j.format};break;default:throw new Error('No RDataType found for "'+j.type+'"');break}b.value.push(d)}return b}b.exports={encode:function(a){var b={};for(var c=0;c<a.length;c++){var d=a[c];switch(d.type){case g.RDATAFRAME:b[d.name]=k(d);break;case g.RLIST:b[d.name]=l(d);break;case g.RNUMERIC_MATRIX:case g.RINTEGER_MATRIX:case g.RBOOLEAN_MATRIX:case g.RSTRING_MATRIX:b[d.name]={type:f.MATRIX,value:d.value};break;case g.RDATE:case g.RPOSIX_DATE:b[d.name]={type:f.DATE,format:d.format,value:i(d.value,d.type)};break;case g.RFACTOR:case g.RORDERED:b[d.name]={type:f.FACTOR,ordered:d.ordered,labels:d.labels,levels:d.levels,value:d.value};break;case g.RSTRING:case g.RBOOLEAN:case g.RNUMERIC:case g.RINTEGER:b[d.name]={type:f.PRIMITIVE,value:d.value};break;case g.RNUMERIC_VECTOR:case g.RINTEGER_VECTOR:case g.RBOOLEAN_VECTOR:case g.RSTRING_VECTOR:b[d.name]={type:f.VECTOR,value:d.value};break;case g.RDATE_VECTOR:case g.RPOSIX_DATE_VECTOR:b[d.name]={type:f.VECTOR,value:h(d.value,d.type),format:d.format};break;default:throw new Error('No RDataType found for "'+d.type+'"');break}}return JSON.stringify(b)}}},{"./lang":24,"./rtypes":30}],23:[function(a,b,c){var d=a("./optional"),e=d("ws"),f=a("./queue"),g=a("./emitter"),h=a("./selfish").Base,i=a("./utils").merge;var j=h.extend(g,{initialize:function k(a,b){g.initialize.call(this,{});this.host=a;this.options=b||{};this.options.log=this.options.log||this.LOG.error;this.ws=null;this.q=new f;this.channel={}},LOG:{info:"info",debug:"debug",error:"error"},open:function(a){var b=this,c=(this.host||"")+"/deployr/r/event/stream?",d=[];a=a||{};a.headers=a.headers||{};a=this.options=i(a,this.channel);this.cookies=!this.cookies?a.headers.Cookie:this.cookies;if(a.project){d.push("project="+a.project)}else{if(a.job){d.push("job="+a.job)}}if(a.management){d.push("managementEventOnly=true")}else{if(a.httponly){d.push("httpEventOnly=true")}else{if(a.revoonly){d.push("revoEventOnly=true")}}}c+=d.join("&").substr(0);c=c.replace(/^http/,"ws");this.q.yield(true);this.q.add(function(){var a=this.cookies?{Cookie:this.cookies}:{};this.emit("es:connecting",{uri:c,headers:a});var d=new e(c,"http",{headers:a});d.onopen=function(a){b.emit("es:open",a)};var f="";d.onmessage=function(a){try{if(a.data.split("!|!")[1]){f=f+a.data.split("!|!")[1];a=JSON.parse(f);f="";var c=a.deployr.response.event.type;b.emit("es:"+c.replace("Event",""),a)}}catch(d){}};d.onerror=function(a){b.emit("es:error",a)};d.onclose=function(a){b.emit("es:disconnect",a)};this.ws=d},this);if(a.force){this.flush()}return this},close:function(){if(this.ws){this.ws.close()}return this},error:function(a){this.on("es:error",a);return this},all:function(){this.channel={revoonly:true};return this},session:function(){this.channel={httponly:true};return this},project:function(a){this.channel={project:a};return this},job:function(a){this.channel={job:a};return this},management:function(){this.channel={management:true};return this},flush:function(){this.q.yield(false);this.q.flush()},share:function(a){this.cookies=a}});b.exports=j},{"./emitter":21,"./optional":26,"./queue":27,"./selfish":31,"./utils":32}],24:[function(a,b,c){var d={},e=Object.prototype.toString,f={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"},g=false;d.isNull=function(a){return a===null};d.isUndefined=function(a){return typeof a==="undefined"};d.isObject=function(a,b){var c=typeof a;return a&&(c==="object"||!b&&(c==="function"||d.isFunction(a)))||false};d.isArray=!g&&Array.isArray||function(a){return d.type(a)==="array"};d.isFunction=function h(a){return typeof a==="function"};d.isBoolean=function(a){return typeof a==="boolean"};d.isDate=function(a){return d.type(a)==="date"&&a.toString()!=="Invalid Date"&&!isNaN(a)};d.isNumber=function(a){return typeof a==="number"&&isFinite(a)};d.isString=function(a){return typeof a==="string"};d.type=function(a){return f[typeof a]||f[e.call(a)]||(a?"object":"null")};b.exports=d},{}],25:[function(a,b,c){var d={},e={},f;function g(a,b){if(!console){return}function c(a){var b="========================================================="+"=========================================================\n",c=0;if(a===d.DEBUG||a===d.ERROR)c=8;else if(a===d.INFO||a===d.WARN)c=8;else c=7;return{start:b.substring(c),end:b}}var e,f=Array.prototype.slice.call(a,0),g=b.name,h=b.level===d.ERROR,i=c(b.level);if(b.level===d.WARN&&console.warn){e="warn"}else if(b.level===d.ERROR&&console.error){e="error"}else if(b.level===d.INFO&&console.info){e="info"}else{e="log"}f.unshift("["+(h?d.ERROR.name:g)+"] "+i.start);f.push(i.end);console[e](f[0],[f[1]+" ---> "+f[2]["call"]]);for(var j=2;j<f.length;j++){console.log(f[j])}}function h(a,b,c){this.id=a;this.context=b||d.DEBUG}h.prototype={log:function(a,b){if(a.value>=this.context.value){g(b,{level:a,name:this.context.name,value:this.context.value})}},debug:function(){this.log(d.DEBUG,arguments)},error:function(){this.log(d.ERROR,arguments)},info:function(){this.log(d.INFO,arguments)},warn:function(){this.log(d.WARN,arguments)},setLevel:function(a){if(a&&"value"in a){this.context=a}}};d.DEBUG={value:1,name:"DEBUG"};d.INFO={value:2,name:"INFO"};d.WARN={value:4,name:"WARN"};d.ERROR={value:8,name:"ERROR"};d.OFF={value:99,name:"OFF"};d.setLevel=function(a){f.setLevel(a)};d.debug=function(){f.debug.apply(f,arguments)};d.info=function(){f.info.apply(f,arguments)};d.warn=function(){f.warn.apply(f,arguments)};d.error=function(){f.error.apply(f,arguments)};d.get=function(a,b,c){return e[a]||function(){e[a]=new h(a,b,c);return e[a]}()};f=d.get("global");b.exports=d},{}],26:[function(a,b,c){b.exports=function(b){try{return a(b)}catch(c){}}},{}],27:[function(a,b,c){function d(){this.emptyCallback=null;this.callbacks=[];this.yielded=false;this.response=null;this.responseChain=[]}d.prototype={add:function(a,b,c){if(!this.yielded&&!c){a.apply(b||this,[this.response])}else{this.callbacks.push({fn:a,ctx:b})}},size:function(){return this.callbacks.length},isEmpty:function(){return this.callbacks.length===0},empty:function(a,b){this.emptyCallback={fn:a,ctx:b}},"yield":function(a){this.yielded=a},take:function(a,b,c){var d;if(a){this.response=a;this.responseChain.push(a)}if(!this.yielded&&this.callbacks[0]){d=this.callbacks.shift();d.fn.apply(d.ctx||this,[this.responseChain,b,c]);if(this.callbacks[0]&&this.emptyCallback){this.emptyCallback.fn.call(this.emptyCallback.ctx||this)}}},flush:function(a,b,c){if(a){this.response=a;this.responseChain.push(a)}while(this.callbacks[0]){if(this.yielded){break}var d=this.callbacks.shift();d.fn.apply(d.ctx||this,[this.responseChain,b,c]);if(this.callbacks[0]&&this.emptyCallback){this.emptyCallback.fn.call(this.emptyCallback.ctx||this)}}}};b.exports=d},{}],28:[function(a,b,c){var d=a("./selfish").Base,e=a("./rtypes");b.exports=d.extend(e,{initialize:function f(a,b,c){this.name=a;this.value=b;this.options=c||{}},numeric:function(){return this.assert({type:this.deployr.RNUMERIC,name:this.name,value:this.value,toString:this.toString})},integer:function(){return this.assert({type:this.deployr.RINTEGER,name:this.name,value:this.value,toString:this.toString})},logical:function(){return this.assert({type:this.deployr.RBOOLEAN,name:this.name,value:this.value,toString:this.toString})},character:function(){return this.assert({type:this.deployr.RSTRING,name:this.name,value:this.value,toString:this.toString})},date:function(){return this.assert({type:this.deployr.RDATE,name:this.name,value:this.value,format:"yyyy-MM-dd",toString:this.toString})},posixct:function(){return this.assert({type:this.deployr.RPOSIX_DATE,name:this.name,value:this.value,format:"yyyy-MM-dd HH:mm:ss Z",toString:this.toString})},numericVector:function(){return this.assert({type:this.deployr.RNUMERIC_VECTOR,name:this.name,value:this.value,toString:this.toString})},integerVector:function(){return this.assert({type:this.deployr.RINTEGER_VECTOR,name:this.name,value:this.value,toString:this.toString})},logicalVector:function(){return this.assert({type:this.deployr.RBOOLEAN_VECTOR,name:this.name,value:this.value,toString:this.toString})},characterVector:function(){return this.assert({type:this.deployr.RSTRING_VECTOR,name:this.name,value:this.value,toString:this.toString})},dateVector:function(){return this.assert({type:this.deployr.RDATE_VECTOR,name:this.name,value:this.value,format:"yyyy-MM-dd",toString:this.toString})},posixctVector:function(){return this.assert({type:this.deployr.RPOSIX_DATE_VECTOR,name:this.name,value:this.value,format:"yyyy-MM-dd HH:mm:ss Z",toString:this.toString})},list:function(){return this.assert({type:this.deployr.RLIST,name:this.name,value:this.value,toString:this.toString})},dataframe:function(){return this.assert({type:this.deployr.RDATAFRAME,name:this.name,value:this.value,toString:this.toString})},factor:function(){var a=this.options;return this.assert({type:this.deployr.RFACTOR,name:this.name,value:this.value,ordered:false,levels:a.levels,labels:a.labels,toString:this.toString})},ordered:function(){var a=this.options;return this.assert({type:this.deployr.RORDERED,name:this.name,value:this.value,ordered:true,levels:a.levels,labels:a.labels,toString:this.toString})},numericMatrix:function(){return this.assert({type:this.deployr.RNUMERIC_MATRIX,name:this.name,value:this.value,toString:this.toString})},integerMatrix:function(){return this.assert({type:this.deployr.RINTEGER_MATRIX,name:this.name,value:this.value,toString:this.toString})},logicalMatrix:function(){return this.assert({type:this.deployr.RBOOLEAN_MATRIX,name:this.name,value:this.value,toString:this.toString})},characterMatrix:function(){return this.assert({type:this.deployr.RSTRING_MATRIX,name:this.name,value:this.value,toString:this.toString})},toString:function(){var a=this.options||{},b=a.levels?"[ levels = "+a.levels+"]":"",c=a.labels?"[ labels = "+a.labels+"]":"";return"[ name = "+this.name+" ] "+"[ value = "+this.value+" ] "+"[ type = "+this.type+" ] "+b+c}})},{"./rtypes":30,"./selfish":31}],29:[function(a,b,c){var d=a("./selfish").Base,e=a("./rtypes"),f=a("./lang"),g=a("./rinput");function h(a,b,c,d){var e;if(f.isObject(b)){e=b;if(!e.type!==a){throw new Error("IllegalArgumentError:"+'Expecting "'+a+'" but found "'+e.type+'"')}}else{e=g.new(b,c,d)[a]()}return e}b.exports=d.extend(e,{numeric:function(a,b){this.inputs.push(h(this.deployr.RNUMERIC,a,b));return this},integer:function(a,b){this.inputs.push(h(this.deployr.RINTEGER,a,b));return this},logical:function(a,b){this.inputs.push(h(this.deployr.RBOOLEAN,a,b));return this},character:function(a,b){this.inputs.push(h(this.deployr.RSTRING,a,b));return this},date:function(a,b){this.inputs.push(h(this.deployr.RDATE,a,b));return this},posixct:function(a,b){this.inputs.push(h(this.deployr.RPOSIX_DATE,a,b));return this},numericVector:function(a,b){this.inputs.push(h(this.deployr.RNUMERIC_VECTOR,a,b));return this},integerVector:function(a,b){this.inputs.push(h(this.deployr.RINTEGER_VECTOR,a,b));return this},logicalVector:function(a,b){this.inputs.push(h(this.deployr.RBOOLEAN_VECTOR,a,b));return this},characterVector:function(a,b){this.inputs.push(h(this.deployr.RSTRING_VECTOR,a,b));return this},dateVector:function(a,b){this.inputs.push(h(this.deployr.RDATE_VECTOR,a,b));return this},posixctVector:function(a,b){this.inputs.push(h(this.deployr.RPOSIX_DATE_VECTOR,a,b));return this},list:function(a,b){this.inputs.push(h(this.deployr.RLIST,a,b));return this},dataframe:function(a,b){this.inputs.push(h(this.deployr.RDATAFRAME,a,b));return this},factor:function(a,b,c,d){var e={levels:c,labels:d};this.inputs.push(h(this.deployr.RFACTOR,a,b,e));return this},ordered:function(a,b,c,d){var e={levels:c,labels:d};this.inputs.push(h(this.deployr.RORDERED,a,b,e));return this},numericMatrix:function(a,b){this.inputs.push(h(this.deployr.RNUMERIC_MATRIX,a,b));return this},integerMatrix:function(a,b){this.inputs.push(h(this.deployr.RINTEGER_MATRIX,a,b));return this},logicalMatrix:function(a,b){this.inputs.push(h(this.deployr.RBOOLEAN_MATRIX,a,b));return this},characterMatrix:function(a,b){this.inputs.push(h(this.deployr.RSTRING_MATRIX,a,b));return this}})},{"./lang":24,"./rinput":28,"./rtypes":30,"./selfish":31}],30:[function(a,b,c){var d=a("./selfish").Base,e=a("./lang"),f={};b.exports=d.extend({r:{PRIMITIVE:"primitive",DATAFRAME:"dataframe",LIST:"list",MATRIX:"matrix",DATE:"date",FACTOR:"factor",VECTOR:"vector"},deployr:{RBOOLEAN:"logical",RNUMERIC:"numeric",RINTEGER:"integer",RSTRING:"character",RDATE:"date",RPOSIX_DATE:"posixct",RBOOLEAN_VECTOR:"logicalVector",RNUMERIC_VECTOR:"numericVector",RINTEGER_VECTOR:"integerVector",RSTRING_VECTOR:"characterVector",RDATE_VECTOR:"dateVector",RPOSIX_DATE_VECTOR:"posixctVector",RLIST:"list",RDATAFRAME:"dataframe",RFACTOR:"factor",RORDERED:"ordered",RBOOLEAN_MATRIX:"logicalMatrix",RNUMERIC_MATRIX:"numericMatrix",RINTEGER_MATRIX:"integerMatrix",RSTRING_MATRIX:"characterMatrix"},isDate:function(a){return a===this.deployr.RDATE||a===this.deployr.RPOSIX_DATE||a===this.deployr.RDATE_VECTOR||a===this.deployr.RPOSIX_DATE_VECTOR||a===this.r.DATE},deployrToR:function(a){var b=this.deployr,c=this.r;if(!f[a]){f[b.RBOOLEAN]=c.PRIMITIVE;f[b.RNUMERIC]=c.PRIMITIVE;f[b.RINTEGER]=c.PRIMITIVE;f[b.RSTRING]=c.PRIMITIVE;f[b.RDATE]=c.DATE;f[b.RPOSIX_DATE]=c.DATE;f[b.RBOOLEAN_VECTOR]=c.VECTOR;f[b.RNUMERIC_VECTOR]=c.VECTOR;f[b.RINTEGER_VECTOR]=c.VECTOR;f[b.RSTRING_VECTOR]=c.VECTOR;f[b.RDATE_VECTOR]=c.VECTOR;f[b.RPOSIX_DATE_VECTOR]=c.VECTOR;f[b.RLIST]=c.LIST;f[b.RDATAFRAME]=c.DATAFRAME;f[b.RFACTOR]=c.FACTOR;f[b.RORDERED]=c.FACTOR;f[b.RBOOLEAN_MATRIX]=c.MATRIX;f[b.RNUMERIC_MATRIX]=c.MATRIX;f[b.RINTEGER_MATRIX]=c.MATRIX;f[b.RSTRING_MATRIX]=c.MATRIX}return f[a]},assert:function(a){var b=this.deployr,c=null,d=a.value,f;d=!e.isArray(d)?[d]:d;for(var g=0;g<d.length;g++){var h=d[g];switch(a.type){case b.RNUMERIC:case b.RNUMERIC_VECTOR:case b.RNUMERIC_VECTOR:f=e.isNumber;var i=parseFloat(h);h=isNaN(i)?h:i;break;case b.RINTEGER:case b.RINTEGER_VECTOR:f=e.isNumber;var i=parseFloat(h);h=isNaN(i)?h:i;break;case b.RBOOLEAN:case b.RBOOLEAN_VECTOR:f=e.isBoolean;break;case b.RSTRING:case b.RSTRING_VECTOR:f=e.isString;break;case b.RDATE:case b.RPOSIX_DATE:case b.RDATE_VECTOR:case b.RPOSIX_DATE_VECTOR:f=e.isDate;break;case b.RFACTOR:case b.RORDERED:case b.RDATAFRAME:case b.RINTEGER_MATRIX:case b.RBOOLEAN_MATRIX:case b.RSTRING_MATRIX:f=c;break}if(f&&!f(h)){throw new Error("RInputFormatError: "+'"'+h+'" is not a valid "'+a.type+'" type.')}}return a}})},{"./lang":24,"./selfish":31}],31:[function(b,c,d){!(typeof a!=="function"?function(a){a(null,typeof d!=="undefined"?d:window)}:a)(function(a,b){"use strict";b.Base=Object.freeze(Object.create(Object.prototype,{"new":{value:function c(){var a=Object.create(this);a.initialize.apply(a,arguments);return a}},initialize:{value:function d(){}},merge:{value:function e(){var a={};Array.prototype.forEach.call(arguments,function(b){Object.getOwnPropertyNames(b).forEach(function(c){a[c]=Object.getOwnPropertyDescriptor(b,c)})});Object.defineProperties(this,a);return this}},extend:{value:function f(){return Object.freeze(this.merge.apply(Object.create(this),arguments))}}}))})},{}],32:[function(a,b,c){var d=a("./lang");var e=c.get=function(a,b){function c(a,b,d){for(var e in a){var f=b.apply(this,[e,a[e],d]);if(f){return f}else{if(a[e]instanceof Object&&!(a[e]instanceof Array)){c(a[e],b,e)}}}}function e(a,b){var d={};c(a,function(a,c,e){if(a===b){d=c;return d}else{return null}});return d}function f(a){for(var b in a){if(a.hasOwnProperty(b))return a}return!d.isObject(a)?a:null}return f(e(a,b))};var f=c.inArray=function(a,b,c){var d,e=a.length;for(d=0;d<e;d++){if(c){if(a[d][c]===b){return a[d]}}else{if(a[d]===b){return a[d]}}}return null};c.merge=function(a,b){if(!a||typeof a!=="object"){a={}}if(!b||typeof b!=="object"){b={}}for(var c in b){a[c]=b[c]}return a};c.workspace=function(a,b){var c=e(a,"workspace");return c?b?f(c.objects,b,"name"):c.objects||c.object:null};c.signature=function(){var a=Array.prototype.slice.call(arguments["0"],0),b=a.length,c,e={};if(b===1&&d.isObject(a[0])){e=a[0];c=e.project?"/r/project/execute/script":"/r/repository/script/execute"}else if(b===1&&d.isString(a[0])){a=a[0].split("/");c="/r/repository/script/execute";e={author:a[1],directory:a[2],filename:a[3]}}else if(b===2){var f=a[1];c=f?"/r/project/execute/script":"/r/repository/script/execute";a=a[0].split("/");e={project:f,author:a[1],directory:a[2],filename:a[3]}}else if(b>2){e={author:a[2],directory:a[1],filename:a[0]}}return{api:c,opts:e}}},{"./lang":24}],33:[function(a,b,c){(function(a){(function(c){"use strict";var d,e=function(a){return typeof a==="function"},f=function(a){return Array.isArray?Array.isArray(a):a instanceof Array},g=function(a){return!!(a&&(typeof a).match(/function|object/))},h=function(a){return a===false||a===c||a===null},i=function(a,b){return[].slice.call(a,b)},j="undefined",k=typeof TypeError===j?Error:TypeError;if(typeof a!==j&&a.nextTick){d=a.nextTick}else if(typeof MessageChannel!==j){var l=new MessageChannel,m=[];l.port1.onmessage=function(){m.length&&m.shift()()};d=function(a){m.push(a);l.port2.postMessage(0)}}else{d=function(a){setTimeout(a,0)}}function n(a){d(function(){throw a})}function o(a){return this.then(a,c)}function p(a){return this.then(c,a)}function q(a,b){return this.then(function(b){return e(a)?a.apply(null,f(b)?b:[b]):u.onlyFuncs?b:a},b||c)}function r(a){function b(){a()}this.then(b,b);return this}function s(a){return this.then(function(b){return e(a)?a.apply(null,f(b)?b.splice(0,0,undefined)&&b:[undefined,b]):u.onlyFuncs?b:a},function(b){return a(b)})}function t(a){return this.then(c,a?function(b){a(b);throw b}:n)}var u=function(a){var b=(c!==a?a:u.alwaysAsync)?d:function(a){a()},f=0,i=[],j,l={then:function(a,c){var d=u();i.push([function(b){try{if(h(a)){d.resolve(b)
}else{d.resolve(e(a)?a(b):u.onlyFuncs?b:a)}}catch(c){d.reject(c)}},function(a){if(h(c)||!e(c)&&u.onlyFuncs){d.reject(a)}if(c){try{d.resolve(e(c)?c(a):c)}catch(b){d.reject(b)}}}]);f!==0&&b(m);return d.promise},success:o,error:p,otherwise:p,apply:q,spread:q,ensure:r,nodify:s,rethrow:t,isPending:function(){return!!(f===0)},getStatus:function(){return f}};l.toSource=l.toString=l.valueOf=function(){return j===c?this:j};function m(){if(f===0){return}var a=i,b=0,c=a.length,d=~f?0:1,e;i=[];for(;b<c;b++){(e=a[b][d])&&e(j)}}function n(a){var c=false;function d(a){return function(b){if(c){return undefined}else{c=true;return a(b)}}}if(f){return this}try{var h=g(a)&&a.then;if(e(h)){if(a===l){throw new k("Promise can't resolve itself")}h.call(a,d(n),d(v));return this}}catch(i){d(v)(i);return this}b(function(){j=a;f=1;m()});return this}function v(a){f||b(function(){try{throw a}catch(b){j=b}f=-1;m()});return this}return{promise:l,resolve:n,fulfill:n,reject:v}};u.deferred=u.defer=u;u.nextTick=d;u.alwaysAsync=true;u.onlyFuncs=true;u.resolved=u.fulfilled=function(a){return u(true).resolve(a).promise};u.rejected=function(a){return u(true).reject(a).promise};u.wait=function(a){var b=u();setTimeout(b.resolve,a||0);return b.promise};u.delay=function(a,b){var c=u();setTimeout(function(){try{c.resolve(a.apply(null))}catch(b){c.reject(b)}},b||0);return c.promise};u.promisify=function(a){if(a&&e(a.then)){return a}return u.resolved(a)};function v(a,b){var c=i(a);if(c.length===1&&f(c[0])){if(!c[0].length){return u.fulfilled([])}c=c[0]}var d=[],e=u(),g=c.length;if(!g){e.resolve(d)}else{var h=function(a){c[a]=u.promisify(c[a]);c[a].then(function(f){if(!(a in d)){d[a]=b?c[a]:f;--g||e.resolve(d)}},function(f){if(!(a in d)){if(!b){e.reject(f)}else{d[a]=c[a];--g||e.resolve(d)}}})};for(var j=0,k=g;j<k;j++){h(j)}}return e.promise}u.all=function(){return v(arguments,false)};u.resolveAll=function(){return v(arguments,true)};u.nodeCapsule=function(a,b){if(!b){b=a;a=void 0}return function(){var c=u(),d=i(arguments);d.push(function(a,b){a?c.reject(a):c.resolve(arguments.length>2?i(arguments,1):b)});try{b.apply(a,d)}catch(e){c.reject(e)}return c.promise}};typeof window!==j&&(window.D=u);typeof b!==j&&b.exports&&(b.exports=u)})()}).call(this,a("/home/nriesland/deployr/production/branches/RRE-7.3-Rel/libraries/javascript/rbroker/node_modules/browserify/node_modules/process/browser.js"))},{"/home/nriesland/deployr/production/branches/RRE-7.3-Rel/libraries/javascript/rbroker/node_modules/browserify/node_modules/process/browser.js":17}],34:[function(a,b,c){var d=a("emitter");var e=a("reduce");var f="undefined"==typeof window?this:window;function g(){}function h(a){var b={}.toString.call(a);switch(b){case"[object File]":case"[object Blob]":case"[object FormData]":return true;default:return false}}function i(){if(f.XMLHttpRequest&&("file:"!=f.location.protocol||!f.ActiveXObject)){return new XMLHttpRequest}else{try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}}return false}var j="".trim?function(a){return a.trim()}:function(a){return a.replace(/(^\s*|\s*$)/g,"")};function k(a){return a===Object(a)}function l(a){if(!k(a))return a;var b=[];for(var c in a){if(null!=a[c]){b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]))}}return b.join("&")}s.serializeObject=l;function m(a){var b={};var c=a.split("&");var d;var e;for(var f=0,g=c.length;f<g;++f){e=c[f];d=e.split("=");b[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return b}s.parseString=m;s.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"};s.serialize={"application/x-www-form-urlencoded":l,"application/json":JSON.stringify};s.parse={"application/x-www-form-urlencoded":m,"application/json":JSON.parse};function n(a){var b=a.split(/\r?\n/);var c={};var d;var e;var f;var g;b.pop();for(var h=0,i=b.length;h<i;++h){e=b[h];d=e.indexOf(":");f=e.slice(0,d).toLowerCase();g=j(e.slice(d+1));c[f]=g}return c}function o(a){return a.split(/ *; */).shift()}function p(a){return e(a.split(/ *; */),function(a,b){var c=b.split(/ *= */),d=c.shift(),e=c.shift();if(d&&e)a[d]=e;return a},{})}function q(a,b){b=b||{};this.req=a;this.xhr=this.req.xhr;this.text=this.xhr.responseText;this.setStatusProperties(this.xhr.status);this.header=this.headers=n(this.xhr.getAllResponseHeaders());this.header["content-type"]=this.xhr.getResponseHeader("content-type");this.setHeaderProperties(this.header);this.body=this.req.method!="HEAD"?this.parseBody(this.text):null}q.prototype.get=function(a){return this.header[a.toLowerCase()]};q.prototype.setHeaderProperties=function(a){var b=this.header["content-type"]||"";this.type=o(b);var c=p(b);for(var d in c)this[d]=c[d]};q.prototype.parseBody=function(a){var b=s.parse[this.type];return b?b(a):null};q.prototype.setStatusProperties=function(a){var b=a/100|0;this.status=a;this.statusType=b;this.info=1==b;this.ok=2==b;this.clientError=4==b;this.serverError=5==b;this.error=4==b||5==b?this.toError():false;this.accepted=202==a;this.noContent=204==a||1223==a;this.badRequest=400==a;this.unauthorized=401==a;this.notAcceptable=406==a;this.notFound=404==a;this.forbidden=403==a};q.prototype.toError=function(){var a=this.req;var b=a.method;var c=a.url;var d="cannot "+b+" "+c+" ("+this.status+")";var e=new Error(d);e.status=this.status;e.method=b;e.url=c;return e};s.Response=q;function r(a,b){var c=this;d.call(this);this._query=this._query||[];this.method=a;this.url=b;this.header={};this._header={};this.on("end",function(){var b=new q(c);if("HEAD"==a)b.text=null;c.callback(null,b)})}d(r.prototype);r.prototype.use=function(a){a(this);return this};r.prototype.timeout=function(a){this._timeout=a;return this};r.prototype.clearTimeout=function(){this._timeout=0;clearTimeout(this._timer);return this};r.prototype.abort=function(){if(this.aborted)return;this.aborted=true;this.xhr.abort();this.clearTimeout();this.emit("abort");return this};r.prototype.set=function(a,b){if(k(a)){for(var c in a){this.set(c,a[c])}return this}this._header[a.toLowerCase()]=b;this.header[a]=b;return this};r.prototype.getHeader=function(a){return this._header[a.toLowerCase()]};r.prototype.type=function(a){this.set("Content-Type",s.types[a]||a);return this};r.prototype.accept=function(a){this.set("Accept",s.types[a]||a);return this};r.prototype.auth=function(a,b){var c=btoa(a+":"+b);this.set("Authorization","Basic "+c);return this};r.prototype.query=function(a){if("string"!=typeof a)a=l(a);if(a)this._query.push(a);return this};r.prototype.field=function(a,b){if(!this._formData)this._formData=new FormData;this._formData.append(a,b);return this};r.prototype.attach=function(a,b,c){if(!this._formData)this._formData=new FormData;this._formData.append(a,b,c);return this};r.prototype.send=function(a){var b=k(a);var c=this.getHeader("Content-Type");if(b&&k(this._data)){for(var d in a){this._data[d]=a[d]}}else if("string"==typeof a){if(!c)this.type("form");c=this.getHeader("Content-Type");if("application/x-www-form-urlencoded"==c){this._data=this._data?this._data+"&"+a:a}else{this._data=(this._data||"")+a}}else{this._data=a}if(!b)return this;if(!c)this.type("json");return this};r.prototype.callback=function(a,b){var c=this._callback;if(2==c.length)return c(a,b);if(a)return this.emit("error",a);c(b)};r.prototype.crossDomainError=function(){var a=new Error("Origin is not allowed by Access-Control-Allow-Origin");a.crossDomain=true;this.callback(a)};r.prototype.timeoutError=function(){var a=this._timeout;var b=new Error("timeout of "+a+"ms exceeded");b.timeout=a;this.callback(b)};r.prototype.withCredentials=function(){this._withCredentials=true;return this};r.prototype.end=function(a){var b=this;var c=this.xhr=i();var d=this._query.join("&");var e=this._timeout;var f=this._formData||this._data;this._callback=a||g;c.onreadystatechange=function(){if(4!=c.readyState)return;if(0==c.status){if(b.aborted)return b.timeoutError();return b.crossDomainError()}b.emit("end")};if(c.upload){c.upload.onprogress=function(a){a.percent=a.loaded/a.total*100;b.emit("progress",a)}}if(e&&!this._timer){this._timer=setTimeout(function(){b.abort()},e)}if(d){d=s.serializeObject(d);this.url+=~this.url.indexOf("?")?"&"+d:"?"+d}c.open(this.method,this.url,true);if(this._withCredentials)c.withCredentials=true;if("GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof f&&!h(f)){var j=s.serialize[this.getHeader("Content-Type")];if(j)f=j(f)}for(var k in this.header){if(null==this.header[k])continue;c.setRequestHeader(k,this.header[k])}this.emit("request",this);c.send(f);return this};s.Request=r;function s(a,b){if("function"==typeof b){return new r("GET",a).end(b)}if(1==arguments.length){return new r("GET",a)}return new r(a,b)}s.get=function(a,b,c){var d=s("GET",a);if("function"==typeof b)c=b,b=null;if(b)d.query(b);if(c)d.end(c);return d};s.head=function(a,b,c){var d=s("HEAD",a);if("function"==typeof b)c=b,b=null;if(b)d.send(b);if(c)d.end(c);return d};s.del=function(a,b){var c=s("DELETE",a);if(b)c.end(b);return c};s.patch=function(a,b,c){var d=s("PATCH",a);if("function"==typeof b)c=b,b=null;if(b)d.send(b);if(c)d.end(c);return d};s.post=function(a,b,c){var d=s("POST",a);if("function"==typeof b)c=b,b=null;if(b)d.send(b);if(c)d.end(c);return d};s.put=function(a,b,c){var d=s("PUT",a);if("function"==typeof b)c=b,b=null;if(b)d.send(b);if(c)d.end(c);return d};b.exports=s},{emitter:35,reduce:36}],35:[function(a,b,c){b.exports=d;function d(a){if(a)return e(a)}function e(a){for(var b in d.prototype){a[b]=d.prototype[b]}return a}d.prototype.on=d.prototype.addEventListener=function(a,b){this._callbacks=this._callbacks||{};(this._callbacks[a]=this._callbacks[a]||[]).push(b);return this};d.prototype.once=function(a,b){var c=this;this._callbacks=this._callbacks||{};function d(){c.off(a,d);b.apply(this,arguments)}d.fn=b;this.on(a,d);return this};d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,b){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var c=this._callbacks[a];if(!c)return this;if(1==arguments.length){delete this._callbacks[a];return this}var d;for(var e=0;e<c.length;e++){d=c[e];if(d===b||d.fn===b){c.splice(e,1);break}}return this};d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d){c[d].apply(this,b)}}return this};d.prototype.listeners=function(a){this._callbacks=this._callbacks||{};return this._callbacks[a]||[]};d.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],36:[function(a,b,c){b.exports=function(a,b,c){var d=0;var e=a.length;var f=arguments.length==3?c:a[d++];while(d<e){f=b.call(null,f,a[d],++d,a)}return f}},{}],37:[function(a,b,c){b.exports={name:"deployr",version:"7.3.0",description:"Simplified JavaScript client library for making requests to DeployR.","private":true,keywords:["deployr","deployr.io","ajax","R","api","simple"],author:"DeployR - Revolution Analytics Inc.",contributors:[{name:"Sean Wells"}],homepage:"http://deployr.revolutionanalytics.com/documents/dev/client-jsdoc",scripts:{start:"gulp start"},devDependencies:{"browserify-shim":"~3.4.1",browserify:"~3.36.0","vinyl-source-stream":"~0.1.1",connect:"~2.14.3",gulp:"^3.8.8","gulp-uglifyjs":"~0.4.2","gulp-plumber":"~0.6.4","gulp-util":"~2.2.20","gulp-livereload":"~2.1.0","gulp-jshint":"^1.7.1","gulp-header":"^1.1.1"},dependencies:{superagent:"^0.18.0","d.js":"^0.6.0",ws:"^0.4.32"},main:"deployr.js",engines:{node:">= 0.10.0"},license:"Apache 2.0 License"}},{}],38:[function(a,b,c){b.exports=a("./lib/enum")},{"./lib/enum":39}],39:[function(b,c,d){(function(b){(function(a,b,c,d){"use strict";function e(a,b){this.key=a;this.value=b}e.prototype={has:function(a){if(a instanceof e||typeof a==="object"&&a.key!==undefined&&a.value!==undefined){return(this.value&a.value)!==0}else if(typeof a==="string"){return this.key.indexOf(a)>=0}else{return(this.value&a)!==0}},is:function(a){if(a instanceof e||typeof a==="object"&&a.key!==undefined&&a.value!==undefined){return this.key===a.key}else if(typeof a==="string"){return this.key===a}else{return this.value===a}},toString:function(){return this.key},toJSON:function(){return this.key},valueOf:function(){return this.key}};function f(a,b){if(b&&typeof b==="string"){b={name:b}}this._options=b||{};this._options.separator=this._options.separator||" | ";this.enums=[];if(a.length){var c=a;a={};for(var d=0;d<c.length;d++){a[c[d]]=Math.pow(2,d)}}for(var f in a){if(this._options.name&&f==="name"||f==="_options"||f==="get"||f==="getKey"||f==="getValue"||f==="enums"||f==="isFlaggable"){throw new Error('Enum key "'+f+'" is a reserved word!')}this[f]=new e(f,a[f]);this.enums.push(this[f])}if(this._options.name){this.name=this._options.name}var g=this;function h(){for(var a=0,b=g.enums.length;a<b;a++){var c=g.enums[a];if(!(c.value!==0&&!(c.value&c.value-1))){return false}}return true}this.isFlaggable=h()}f.prototype={getKey:function(a){var b=this.get(a);if(b){return b.key}else{return"Undefined"}},getValue:function(a){var b=this.get(a);if(b){return b.value}else{return null}},get:function(a){if(a===null||a===undefined)return null;if(a instanceof e||typeof a==="object"&&a.key!==undefined&&a.value!==undefined){var b=this.enums.indexOf(a);if(b>=0){return a}if(!this.isFlaggable||this.isFlaggable&&a.key.indexOf(this._options.separator)<0){return null}return this.get(a.key)}else if(typeof a==="string"){if(a.indexOf(this._options.separator)>0){var c=a.split(this._options.separator);var d=0;for(var f=0;f<c.length;f++){var g=c[f];d|=this[g].value}return new e(a,d)}else{return this[a]}}else{for(var h in this){if(this.hasOwnProperty(h)){if(this[h].value===a){return this[h]}}}var i=null;if(this.isFlaggable){for(var j in this){if(this.hasOwnProperty(j)){if((a&this[j].value)!==0){if(i){i+=this._options.separator}else{i=""}i+=j}}}}return this.get(i||null)}}};if(b&&b.exports){b.exports=f}else if(d){d(function(){return f})}else{a.Enum=f}if(b&&b.exports&&c){f.register=function(a){a=a||"Enum";if(!c[a]){c[a]=f}}}})(this,typeof c!=="undefined"?c:undefined,typeof b!=="undefined"?b:undefined,typeof a!=="undefined"?a:undefined)}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],40:[function(a,b,c){(function(a){function c(){var a=Array.prototype.slice.call(arguments),b=a.shift(),c=b===true,f=a.length,g,h,i;if(c||e(b)!=="object")b={};for(h=0;h<f;++h)if(e(g=a[h])==="object")for(i in g)b[i]=c?d(g[i]):g[i];return b}function d(a){var b=a,c=e(a),f,g;if(c==="array"){b=[];g=a.length;for(f=0;f<g;++f)b[f]=d(a[f])}else if(c==="object"){b={};for(f in a)b[f]=d(a[f])}return b}function e(a){return{}.toString.call(a).match(/\s([\w]+)/)[1].toLowerCase()}if(a){b.exports=c}else{window.merge=c}})(typeof b==="object"&&b&&typeof b.exports==="object"&&b.exports)},{}],41:[function(b,c,d){!(typeof a!=="function"?function(a){a(null,typeof d!=="undefined"?d:window)}:a)(function(a,b){"use strict";b.Base=Object.freeze(Object.create(Object.prototype,{"new":{value:function c(){var a=Object.create(this);a.initialize.apply(a,arguments);return a}},initialize:{value:function d(){}},merge:{value:function e(){var a={};Array.prototype.forEach.call(arguments,function(b){Object.getOwnPropertyNames(b).forEach(function(c){a[c]=Object.getOwnPropertyDescriptor(b,c)})});Object.defineProperties(this,a);return this}},extend:{value:function f(){return Object.freeze(this.merge.apply(Object.create(this),arguments))}}}))})},{}],42:[function(b,c,d){(function(a){"use strict";a(function(a){var b=a("./makePromise");var c=a("./Scheduler");var d=a("./async");return b({scheduler:new c(d)})})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a(b)})},{"./Scheduler":44,"./async":46,"./makePromise":56}],43:[function(b,c,d){(function(a){"use strict";a(function(){function a(a){this.head=this.tail=this.length=0;this.buffer=new Array(1<<a)}a.prototype.push=function(a){if(this.length===this.buffer.length){this._ensureCapacity(this.length*2)}this.buffer[this.tail]=a;this.tail=this.tail+1&this.buffer.length-1;++this.length;return this.length};a.prototype.shift=function(){var a=this.buffer[this.head];this.buffer[this.head]=void 0;this.head=this.head+1&this.buffer.length-1;--this.length;return a};a.prototype._ensureCapacity=function(a){var b=this.head;var c=this.buffer;var d=new Array(a);var e=0;var f;if(b===0){f=this.length;for(;e<f;++e){d[e]=c[e]}}else{a=c.length;f=this.tail;for(;b<a;++e,++b){d[e]=c[b]}for(b=0;b<f;++e,++b){d[e]=c[b]}}this.buffer=d;this.head=0;this.tail=this.length};return a})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a()})},{}],44:[function(b,c,d){(function(a){"use strict";a(function(a){var b=a("./Queue");function c(a){this._async=a;this._queue=new b(15);this._afterQueue=new b(5);this._running=false;var c=this;this.drain=function(){c._drain()}}c.prototype.enqueue=function(a){this._add(this._queue,a)};c.prototype.afterQueue=function(a){this._add(this._afterQueue,a)};c.prototype._drain=function(){d(this._queue);this._running=false;d(this._afterQueue)};c.prototype._add=function(a,b){a.push(b);if(!this._running){this._running=true;this._async(this.drain)}};function d(a){while(a.length>0){a.shift().run()}}return c})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a(b)})},{"./Queue":43}],45:[function(b,c,d){(function(a){"use strict";a(function(){function a(b){Error.call(this);this.message=b;this.name=a.name;if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,a)}}a.prototype=Object.create(Error.prototype);a.prototype.constructor=a;return a})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a()})},{}],46:[function(b,c,d){(function(d){(function(a){"use strict";a(function(a){var b,c;if(typeof d!=="undefined"&&d!==null&&typeof d.nextTick==="function"){b=function(a){d.nextTick(a)}}else if(c=typeof MutationObserver==="function"&&MutationObserver||typeof WebKitMutationObserver==="function"&&WebKitMutationObserver){b=function(a,b){var c;var d=a.createElement("div");var e=new b(f);e.observe(d,{attributes:true});function f(){var a=c;c=void 0;a()}return function(a){c=a;d.setAttribute("class","x")}}(document,c)}else{b=function(a){var b;try{b=a("vertx")}catch(c){}if(b){if(typeof b.runOnLoop==="function"){return b.runOnLoop}if(typeof b.runOnContext==="function"){return b.runOnContext}}var d=setTimeout;return function(a){d(a,0)}}(a)}return b})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a(b)})}).call(this,b("/home/nriesland/deployr/production/branches/RRE-7.3-Rel/libraries/javascript/rbroker/node_modules/browserify/node_modules/process/browser.js"))},{"/home/nriesland/deployr/production/branches/RRE-7.3-Rel/libraries/javascript/rbroker/node_modules/browserify/node_modules/process/browser.js":17}],47:[function(b,c,d){(function(a){"use strict";a(function(){return function a(b){var c=Array.prototype.reduce;var d=Array.prototype.reduceRight;var e=b.resolve;var f=b.all;b.any=g;b.some=h;b.settle=l;b.map=j;b.filter=k;b.reduce=m;b.reduceRight=n;b.prototype.spread=function(a){return this.then(f).then(function(b){return a.apply(void 0,b)})};return b;function g(a){return new b(function(b,c){var d=[];var e=i(a,b,f);if(e===0){c(new RangeError("any() input must not be empty"))}function f(a){d.push(a);if(--e===0){c(d)}}})}function h(a,c){return new b(function(b,d,e){var f=[];var g=[];var h;var j=i(a,k,l,e);c=Math.max(c,0);h=j-c+1;j=Math.min(c,j);if(c>j){d(new RangeError("some() input must contain at least "+c+" element(s), but had "+j))}else if(j===0){b(f)}function k(a){if(j>0){--j;f.push(a);if(j===0){b(f)}}}function l(a){if(h>0){--h;g.push(a);if(h===0){d(g)}}}})}function i(a,b,d,f){return c.call(a,function(a,c){e(c).then(b,d,f);return a+1},0)}function j(a,b){if(typeof a!=="object"){return e([])}return f(p(function(a,b){return e(a).fold(c,b)},a));function c(a,c){return b(c,a)}}function k(a,b){return f(a).then(function(a){return f(p(b,a)).then(function(b){var c=b.length;var d=new Array(c);for(var e=0,f=0,g;e<c;++e){g=b[e];if(g===void 0&&!(e in b)){continue}if(b[e]){d[f++]=a[e]}}d.length=f;return d})})}function l(a){return f(p(function(a){a=e(a);return a.then(b,b);function b(){return a.inspect()}},a))}function m(a,b){var d=o(b);return arguments.length>2?c.call(a,d,arguments[2]):c.call(a,d)}function n(a,b){var c=o(b);return arguments.length>2?d.call(a,c,arguments[2]):d.call(a,c)}function o(a){return function b(c,d,f){return e(c).then(function(b){return e(d).then(function(c){return a(b,c,f)})})}}function p(a,b){var c=b.length;var d=new Array(c);for(var e=0,f;e<c;++e){f=b[e];if(f===void 0&&!(e in b)){continue}d[e]=a(b[e],e)}return d}}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a()})},{}],48:[function(b,c,d){(function(a){"use strict";a(function(){return function f(c){var f=c.resolve;var g=c.reject;var h=c.prototype["catch"];c.prototype.done=function(a,b){this._handler.visit(this._handler.receiver,a,b)};c.prototype["catch"]=c.prototype.otherwise=function(b){if(arguments.length<2){return h.call(this,b)}else{if(typeof b!=="function"){return this.ensure(a)}return h.call(this,i(arguments[1],b))}};function i(a,c){return function(d){return b(d,c)?a.call(this,d):g(d)}}c.prototype["finally"]=c.prototype.ensure=function(a){if(typeof a!=="function"){return this}return this.then(function(b){return j(a,this,e,b)},function(b){return j(a,this,g,b)})};function j(a,b,c,e){var f=a.call(b);return d(f)?k(f,c,e):c(e)}function k(a,b,c){return f(a).then(function(){return b(c)})}c.prototype["else"]=c.prototype.orElse=function(a){return this.then(void 0,function(){return a})};c.prototype["yield"]=function(a){return this.then(function(){return a})};c.prototype.tap=function(a){return this.then(a)["yield"](this)};return c};function a(){throw new TypeError("catch predicate must be a function")}function b(a,b){return c(b)?a instanceof b:b(a)}function c(a){return a===Error||a!=null&&a.prototype instanceof Error}function d(a){return(typeof a==="object"||typeof a==="function")&&a!==null}function e(a){return a}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a()})},{}],49:[function(b,c,d){(function(a){"use strict";a(function(){return function a(b){b.prototype.fold=function(a,c){var d=this._beget();this._handler.fold(function(c,d,e){b._handler(c).fold(function(b,c,d){d.resolve(a.call(this,c,b))},d,this,e)},c,d._handler.receiver,d._handler);return d};return b}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a()})},{}],50:[function(b,c,d){(function(a){"use strict";a(function(){return function a(b){b.prototype.inspect=function(){return c(b._handler(this))};function c(a){var b=a.state();if(b===0){return{state:"pending"}}if(b>0){return{state:"fulfilled",value:a.value}}return{state:"rejected",reason:a.value}}return b}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a()})},{}],51:[function(b,c,d){(function(a){"use strict";a(function(){return function a(b){var c=b.resolve;b.iterate=d;b.unfold=e;return b;function d(a,b,c,d){return e(function(b){return[b,a(b)]},b,c,d)}function e(a,b,d,f){return c(f).then(function(d){return c(b(d)).then(function(b){return b?d:c(a(d)).spread(g)})});function g(f,g){return c(d(f)).then(function(){return e(a,b,d,g)})}}}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a()})},{}],52:[function(b,c,d){(function(a){"use strict";a(function(){return function a(b){b.prototype.progress=function(a){return this.then(void 0,void 0,a)};return b}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a()})},{}],53:[function(b,c,d){(function(a){"use strict";a(function(a){var b=a("../timer");var c=a("../TimeoutError");function d(a,c,d,e){return b.set(function(){a(d,e,c)},c)}return function e(a){a.prototype.delay=function(a){var b=this._beget();this._handler.fold(e,a,void 0,b._handler);return b};function e(a,b,c){d(f,a,b,c)}function f(a,b){b.resolve(a)}a.prototype.timeout=function(a,c){var e=this._beget();var f=e._handler;var h=d(g,a,c,e._handler);this._handler.visit(f,function i(a){b.clear(h);this.resolve(a)},function j(a){b.clear(h);this.reject(a)},f.notify);return e};function g(a,b,d){var e=typeof a==="undefined"?new c("timed out after "+d+"ms"):a;b.reject(e)}return a}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a(b)})},{"../TimeoutError":45,"../timer":57}],54:[function(b,c,d){(function(a){"use strict";a(function(a){var b=a("../timer");return function h(a){var e=g;var h=g;if(typeof console!=="undefined"){e=typeof console.error!=="undefined"?function(a){console.error(a)}:function(a){console.log(a)};h=typeof console.info!=="undefined"?function(a){console.info(a)}:function(a){console.log(a)}}a.onPotentiallyUnhandledRejection=function(a){n(l,a)};a.onPotentiallyUnhandledRejectionHandled=function(a){n(m,a)};a.onFatalRejection=function(a){n(f,a.value)};var i=[];var j=[];var k=false;function l(a){if(!a.handled){j.push(a);e("Potentially unhandled rejection ["+a.id+"] "+c(a.value))}}function m(a){var b=j.indexOf(a);if(b>=0){j.splice(b,1);h("Handled previous rejection ["+a.id+"] "+d(a.value))}}function n(a,c){i.push(a,c);if(!k){k=true;k=b.set(o,0)}}function o(){k=false;while(i.length>0){i.shift()(i.shift())}}return a};function c(a){var b=typeof a==="object"&&a.stack?a.stack:d(a);return a instanceof Error?b:b+" (WARNING: non-Error used)"}function d(a){var b=String(a);if(b==="[object Object]"&&typeof JSON!=="undefined"){b=e(a,b)}return b}function e(a,b){try{return JSON.stringify(a)}catch(a){return b}}function f(a){throw a}function g(){}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a(b)})},{"../timer":57}],55:[function(b,c,d){(function(a){"use strict";a(function(){return function a(b){b.prototype["with"]=b.prototype.withThis=function(a){var b=this._beget();var c=b._handler;c.receiver=a;this._handler.chain(c,a);return b};return b}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a()})},{}],56:[function(b,c,d){(function(a){"use strict";a(function(){return function a(b){var c=b.scheduler;var d=Object.create||function(a){function b(){}b.prototype=a;return new b};function e(a,b){this._handler=a===q?b:f(a)}function f(a){var b=new t;try{a(d,e,f)}catch(c){e(c)}return b;function d(a){b.resolve(a)}function e(a){b.reject(a)}function f(a){b.notify(a)}}e.resolve=g;e.reject=h;e.never=i;e._defer=j;e._handler=n;function g(a){return I(a)?a:new e(q,new u(n(a)))}function h(a){return new e(q,new u(new y(a)))}function i(){return C}function j(){return new e(q,new t)}e.prototype.then=function(a,b){var c=this._handler;var d=c.join().state();if(typeof a!=="function"&&d>0||typeof b!=="function"&&d<0){return new this.constructor(q,c)}var e=this._beget();var f=e._handler;c.chain(f,c.receiver,a,b,arguments.length>2?arguments[2]:void 0);return e};e.prototype["catch"]=function(a){return this.then(void 0,a)};e.prototype._beget=function(){var a=this._handler;var b=new t(a.receiver,a.join().context);return new this.constructor(q,b)};e.all=k;e.race=m;function k(a){var b=new t;var c=a.length>>>0;var d=new Array(c);var f,g,h,i;for(f=0;f<a.length;++f){h=a[f];if(h===void 0&&!(f in a)){--c;continue}if(J(h)){g=o(h);i=g.state();if(i===0){g.fold(j,f,d,b)}else if(i>0){d[f]=g.value;--c}else{l(a,f+1,g);b.become(g);break}}else{d[f]=h;--c}}if(c===0){b.become(new w(d))}return new e(q,b);function j(a,b,d){this[a]=b;if(--c===0){d.become(new w(this))}}}function l(a,b,c){var d,e,f;for(d=b;d<a.length;++d){f=a[d];if(J(f)){e=o(f);if(e!==c){e.visit(e,void 0,e._unreport)}}}}function m(a){if(Object(a)===a&&a.length===0){return i()}var b=new t;var c,d;for(c=0;c<a.length;++c){d=a[c];if(d!==void 0&&c in a){n(d).visit(b,b.resolve,b.reject)}}return new e(q,b)}function n(a){if(I(a)){return a._handler.join()}return J(a)?p(a):new w(a)}function o(a){return I(a)?a._handler.join():p(a)}function p(a){try{var b=a.then;return typeof b==="function"?new v(b,a):new w(a)}catch(c){return new y(c)}}function q(){}q.prototype.when=q.prototype.become=q.prototype.notify=q.prototype.fail=q.prototype._unreport=q.prototype._report=R;q.prototype._state=0;q.prototype.state=function(){return this._state};q.prototype.join=function(){var a=this;while(a.handler!==void 0){a=a.handler}return a};q.prototype.chain=function(a,b,c,d,e){this.when({resolver:a,receiver:b,fulfilled:c,rejected:d,progress:e})};q.prototype.visit=function(a,b,c,d){this.chain(s,a,b,c,d)};q.prototype.fold=function(a,b,c,d){this.visit(d,function(d){a.call(c,b,d,this)},d.reject,d.notify)};function r(){}Q(q,r);r.prototype.become=function(a){a.fail()};var s=new r;function t(a,b){e.createContext(this,b);this.consumers=void 0;this.receiver=a;this.handler=void 0;this.resolved=false}Q(q,t);t.prototype._state=0;t.prototype.resolve=function(a){this.become(n(a))};t.prototype.reject=function(a){if(this.resolved){return}this.become(new y(a))};t.prototype.join=function(){if(!this.resolved){return this}var a=this;while(a.handler!==void 0){a=a.handler;if(a===this){return this.handler=D()}}return a};t.prototype.run=function(){var a=this.consumers;var b=this.join();this.consumers=void 0;for(var c=0;c<a.length;++c){b.when(a[c])}};t.prototype.become=function(a){if(this.resolved){return}this.resolved=true;this.handler=a;if(this.consumers!==void 0){c.enqueue(this)}if(this.context!==void 0){a._report(this.context)}};t.prototype.when=function(a){if(this.resolved){c.enqueue(new E(a,this.handler))}else{if(this.consumers===void 0){this.consumers=[a]}else{this.consumers.push(a)}}};t.prototype.notify=function(a){if(!this.resolved){c.enqueue(new F(a,this))}};t.prototype.fail=function(a){var b=typeof a==="undefined"?this.context:a;this.resolved&&this.handler.join().fail(b)};t.prototype._report=function(a){this.resolved&&this.handler.join()._report(a)};t.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()};function u(a){this.handler=a}Q(q,u);u.prototype.when=function(a){c.enqueue(new E(a,this))};u.prototype._report=function(a){this.join()._report(a)};u.prototype._unreport=function(){this.join()._unreport()};function v(a,b){t.call(this);c.enqueue(new G(a,b,this))}Q(t,v);function w(a){e.createContext(this);this.value=a}Q(q,w);w.prototype._state=1;w.prototype.fold=function(a,b,c,d){L(a,b,this,c,d)};w.prototype.when=function(a){K(a.fulfilled,this,a.receiver,a.resolver)};var x=0;function y(a){e.createContext(this);this.id=++x;this.value=a;this.handled=false;this.reported=false;this._report()}Q(q,y);y.prototype._state=-1;y.prototype.fold=function(a,b,c,d){d.become(this)};y.prototype.when=function(a){if(typeof a.rejected==="function"){this._unreport()}K(a.rejected,this,a.receiver,a.resolver)};y.prototype._report=function(a){c.afterQueue(new z(this,a))};y.prototype._unreport=function(){this.handled=true;c.afterQueue(new A(this))};y.prototype.fail=function(a){e.onFatalRejection(this,a===void 0?this.context:a)};function z(a,b){this.rejection=a;this.context=b}z.prototype.run=function(){if(!this.rejection.handled){this.rejection.reported=true;e.onPotentiallyUnhandledRejection(this.rejection,this.context)}};function A(a){this.rejection=a}A.prototype.run=function(){if(this.rejection.reported){e.onPotentiallyUnhandledRejectionHandled(this.rejection)}};e.createContext=e.enterContext=e.exitContext=e.onPotentiallyUnhandledRejection=e.onPotentiallyUnhandledRejectionHandled=e.onFatalRejection=R;var B=new q;var C=new e(q,B);function D(){return new y(new TypeError("Promise cycle"))}function E(a,b){this.continuation=a;this.handler=b}E.prototype.run=function(){this.handler.join().when(this.continuation)};function F(a,b){this.handler=b;this.value=a}F.prototype.run=function(){var a=this.handler.consumers;if(a===void 0){return}for(var b,c=0;c<a.length;++c){b=a[c];M(b.progress,this.value,this.handler,b.receiver,b.resolver)}};function G(a,b,c){this._then=a;this.thenable=b;this.resolver=c}G.prototype.run=function(){var a=this.resolver;
H(this._then,this.thenable,b,c,d);function b(b){a.resolve(b)}function c(b){a.reject(b)}function d(b){a.notify(b)}};function H(a,b,c,d,e){try{a.call(b,c,d,e)}catch(f){d(f)}}function I(a){return a instanceof e}function J(a){return(typeof a==="object"||typeof a==="function")&&a!==null}function K(a,b,c,d){if(typeof a!=="function"){return d.become(b)}e.enterContext(b);N(a,b.value,c,d);e.exitContext()}function L(a,b,c,d,f){if(typeof a!=="function"){return f.become(c)}e.enterContext(c);O(a,b,c.value,d,f);e.exitContext()}function M(a,b,c,d,f){if(typeof a!=="function"){return f.notify(b)}e.enterContext(c);P(a,b,d,f);e.exitContext()}function N(a,b,c,d){try{d.become(n(a.call(c,b)))}catch(e){d.become(new y(e))}}function O(a,b,c,d,e){try{a.call(d,b,c,e)}catch(f){e.become(new y(f))}}function P(a,b,c,d){try{d.notify(a.call(c,b))}catch(e){d.notify(e)}}function Q(a,b){b.prototype=d(a.prototype);b.prototype.constructor=b}function R(){}return e}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a()})},{}],57:[function(b,c,d){(function(a){"use strict";a(function(a){var b,c,d,e;b=a;try{c=b("vertx")}catch(f){}if(c&&typeof c.setTimer==="function"){d=function(a,b){return c.setTimer(b,a)};e=c.cancelTimer}else{d=function(a,b){return setTimeout(a,b|0)};e=function(a){return clearTimeout(a)}}return{set:d,clear:e}})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a(b)})},{}],58:[function(b,c,d){(function(a){"use strict";a(function(a){var b=a("./lib/decorators/timed");var c=a("./lib/decorators/array");var d=a("./lib/decorators/flow");var e=a("./lib/decorators/fold");var f=a("./lib/decorators/inspect");var g=a("./lib/decorators/iterate");var h=a("./lib/decorators/progress");var i=a("./lib/decorators/with");var j=a("./lib/decorators/unhandledRejection");var k=a("./lib/TimeoutError");var l=[c,d,e,g,h,f,i,b,j].reduce(function(a,b){return b(a)},a("./lib/Promise"));var m=Array.prototype.slice;n.promise=o;n.resolve=l.resolve;n.reject=l.reject;n.lift=p;n["try"]=q;n.attempt=q;n.iterate=l.iterate;n.unfold=l.unfold;n.join=v;n.all=w;n.settle=x;n.any=p(l.any);n.some=p(l.some);n.race=p(l.race);n.map=y;n.filter=z;n.reduce=A;n.reduceRight=B;n.isPromiseLike=u;n.Promise=l;n.defer=s;n.TimeoutError=k;function n(a,b,c){var d=l.resolve(a);if(arguments.length<2){return d}return arguments.length>3?d.then(b,c,arguments[3]):d.then(b,c)}function o(a){return new l(a)}function p(a){return function(){return r(a,this,m.call(arguments))}}function q(a){return r(a,this,m.call(arguments,1))}function r(a,b,c){return l.all(c).then(function(c){return a.apply(b,c)})}function s(){return new t}function t(){var a=l._defer();function b(b){a._handler.resolve(b)}function c(b){a._handler.reject(b)}function d(b){a._handler.notify(b)}this.promise=a;this.resolve=b;this.reject=c;this.notify=d;this.resolver={resolve:b,reject:c,notify:d}}function u(a){return a&&typeof a.then==="function"}function v(){return l.all(arguments)}function w(a){return n(a,l.all)}function x(a){return n(a,l.settle)}function y(a,b){return n(a,function(a){return l.map(a,b)})}function z(a,b){return n(a,function(a){return l.filter(a,b)})}function A(a,b){var c=m.call(arguments,1);return n(a,function(a){c.unshift(a);return l.reduce.apply(l,c)})}function B(a,b){var c=m.call(arguments,1);return n(a,function(a){c.unshift(a);return l.reduceRight.apply(l,c)})}return n})})(typeof a==="function"&&a.amd?a:function(a){c.exports=a(b)})},{"./lib/Promise":42,"./lib/TimeoutError":45,"./lib/decorators/array":47,"./lib/decorators/flow":48,"./lib/decorators/fold":49,"./lib/decorators/inspect":50,"./lib/decorators/iterate":51,"./lib/decorators/progress":52,"./lib/decorators/timed":53,"./lib/decorators/unhandledRejection":54,"./lib/decorators/with":55}],59:[function(a,b,c){var d=a("./lib/task/discreate-task"),e=a("./lib/task/pooled-task"),f=a("./lib/task/background-task"),g=a("./lib/engine/discrete-task-broker"),h=a("./lib/engine/pooled-task-broker"),i=a("./lib/engine/background-task-broker");if(typeof window!=="undefined"&&!window.deployr){window.deployr=a("deployr")}b.exports={discreteTaskBroker:function(a){return g.new(a)},pooledTaskBroker:function(a){return h.new(a)},backgroundTaskBroker:function(a){return i.new(a)},discreteTask:function(a){return d.new(a)},pooledTask:function(a){return e.new(a)},backgroundTask:function(a){return f.new(a)}}},{"./lib/engine/background-task-broker":1,"./lib/engine/discrete-task-broker":2,"./lib/engine/pooled-task-broker":3,"./lib/task/background-task":7,"./lib/task/discreate-task":8,"./lib/task/pooled-task":9,deployr:19}]},{},[59])(59)});